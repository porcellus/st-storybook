/*! For license information please see 29.d9531dc2.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunksupertokens_auth_react=self.webpackChunksupertokens_auth_react||[]).push([[29],{"./node_modules/css-loader/dist/runtime/api.js":function(module){module.exports=function(cssWithMappingToString){var list=[];return list.toString=function toString(){return this.map((function(item){var content="",needLayer=void 0!==item[5];return item[4]&&(content+="@supports (".concat(item[4],") {")),item[2]&&(content+="@media ".concat(item[2]," {")),needLayer&&(content+="@layer".concat(item[5].length>0?" ".concat(item[5]):""," {")),content+=cssWithMappingToString(item),needLayer&&(content+="}"),item[2]&&(content+="}"),item[4]&&(content+="}"),content})).join("")},list.i=function i(modules,media,dedupe,supports,layer){"string"==typeof modules&&(modules=[[null,modules,void 0]]);var alreadyImportedModules={};if(dedupe)for(var k=0;k<this.length;k++){var id=this[k][0];null!=id&&(alreadyImportedModules[id]=!0)}for(var _k=0;_k<modules.length;_k++){var item=[].concat(modules[_k]);dedupe&&alreadyImportedModules[item[0]]||(void 0!==layer&&(void 0===item[5]||(item[1]="@layer".concat(item[5].length>0?" ".concat(item[5]):""," {").concat(item[1],"}")),item[5]=layer),media&&(item[2]?(item[1]="@media ".concat(item[2]," {").concat(item[1],"}"),item[2]=media):item[2]=media),supports&&(item[4]?(item[1]="@supports (".concat(item[4],") {").concat(item[1],"}"),item[4]=supports):item[4]="".concat(supports)),list.push(item))}},list}},"./node_modules/css-loader/dist/runtime/sourceMaps.js":function(module){module.exports=function(item){var content=item[1],cssMapping=item[3];if(!cssMapping)return content;if("function"==typeof btoa){var base64=btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping)))),data="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(base64),sourceMapping="/*# ".concat(data," */");return[content].concat([sourceMapping]).join("\n")}return[content].join("\n")}},"./node_modules/react/cjs/react-jsx-runtime.production.min.js":function(__unused_webpack_module,exports,__webpack_require__){var f=__webpack_require__("./node_modules/react/index.js"),k=Symbol.for("react.element"),l=Symbol.for("react.fragment"),m=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};function q(c,a,g){var b,d={},e=null,h=null;for(b in void 0!==g&&(e=""+g),void 0!==a.key&&(e=""+a.key),void 0!==a.ref&&(h=a.ref),a)m.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:k,type:c,key:e,ref:h,props:d,_owner:n.current}}exports.Fragment=l,exports.jsx=q,exports.jsxs=q},"./node_modules/react/jsx-runtime.js":function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__("./node_modules/react/cjs/react-jsx-runtime.production.min.js")},"./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js":function(module){var stylesInDOM=[];function getIndexByIdentifier(identifier){for(var result=-1,i=0;i<stylesInDOM.length;i++)if(stylesInDOM[i].identifier===identifier){result=i;break}return result}function modulesToDom(list,options){for(var idCountMap={},identifiers=[],i=0;i<list.length;i++){var item=list[i],id=options.base?item[0]+options.base:item[0],count=idCountMap[id]||0,identifier="".concat(id," ").concat(count);idCountMap[id]=count+1;var indexByIdentifier=getIndexByIdentifier(identifier),obj={css:item[1],media:item[2],sourceMap:item[3],supports:item[4],layer:item[5]};if(-1!==indexByIdentifier)stylesInDOM[indexByIdentifier].references++,stylesInDOM[indexByIdentifier].updater(obj);else{var updater=addElementStyle(obj,options);options.byIndex=i,stylesInDOM.splice(i,0,{identifier:identifier,updater:updater,references:1})}identifiers.push(identifier)}return identifiers}function addElementStyle(obj,options){var api=options.domAPI(options);api.update(obj);return function updater(newObj){if(newObj){if(newObj.css===obj.css&&newObj.media===obj.media&&newObj.sourceMap===obj.sourceMap&&newObj.supports===obj.supports&&newObj.layer===obj.layer)return;api.update(obj=newObj)}else api.remove()}}module.exports=function(list,options){var lastIdentifiers=modulesToDom(list=list||[],options=options||{});return function update(newList){newList=newList||[];for(var i=0;i<lastIdentifiers.length;i++){var index=getIndexByIdentifier(lastIdentifiers[i]);stylesInDOM[index].references--}for(var newLastIdentifiers=modulesToDom(newList,options),_i=0;_i<lastIdentifiers.length;_i++){var _index=getIndexByIdentifier(lastIdentifiers[_i]);0===stylesInDOM[_index].references&&(stylesInDOM[_index].updater(),stylesInDOM.splice(_index,1))}lastIdentifiers=newLastIdentifiers}}},"./node_modules/style-loader/dist/runtime/insertBySelector.js":function(module){var memo={};module.exports=function insertBySelector(insert,style){var target=function getTarget(target){if(void 0===memo[target]){var styleTarget=document.querySelector(target);if(window.HTMLIFrameElement&&styleTarget instanceof window.HTMLIFrameElement)try{styleTarget=styleTarget.contentDocument.head}catch(e){styleTarget=null}memo[target]=styleTarget}return memo[target]}(insert);if(!target)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");target.appendChild(style)}},"./node_modules/style-loader/dist/runtime/insertStyleElement.js":function(module){module.exports=function insertStyleElement(options){var element=document.createElement("style");return options.setAttributes(element,options.attributes),options.insert(element,options.options),element}},"./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js":function(module,__unused_webpack_exports,__webpack_require__){module.exports=function setAttributesWithoutAttributes(styleElement){var nonce=__webpack_require__.nc;nonce&&styleElement.setAttribute("nonce",nonce)}},"./node_modules/style-loader/dist/runtime/styleDomAPI.js":function(module){module.exports=function domAPI(options){if("undefined"==typeof document)return{update:function update(){},remove:function remove(){}};var styleElement=options.insertStyleElement(options);return{update:function update(obj){!function apply(styleElement,options,obj){var css="";obj.supports&&(css+="@supports (".concat(obj.supports,") {")),obj.media&&(css+="@media ".concat(obj.media," {"));var needLayer=void 0!==obj.layer;needLayer&&(css+="@layer".concat(obj.layer.length>0?" ".concat(obj.layer):""," {")),css+=obj.css,needLayer&&(css+="}"),obj.media&&(css+="}"),obj.supports&&(css+="}");var sourceMap=obj.sourceMap;sourceMap&&"undefined"!=typeof btoa&&(css+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))))," */")),options.styleTagTransform(css,styleElement,options.options)}(styleElement,options,obj)},remove:function remove(){!function removeStyleElement(styleElement){if(null===styleElement.parentNode)return!1;styleElement.parentNode.removeChild(styleElement)}(styleElement)}}}},"./node_modules/style-loader/dist/runtime/styleTagTransform.js":function(module){module.exports=function styleTagTransform(css,styleElement){if(styleElement.styleSheet)styleElement.styleSheet.cssText=css;else{for(;styleElement.firstChild;)styleElement.removeChild(styleElement.firstChild);styleElement.appendChild(document.createTextNode(css))}}},"../supertokens-web-js/node_modules/browser-tabs-lock/index.js":function(__unused_webpack_module,exports,__webpack_require__){var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P((function(resolve){resolve(result.value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}},_this=this;Object.defineProperty(exports,"__esModule",{value:!0});var processLock_1=__webpack_require__("../supertokens-web-js/node_modules/browser-tabs-lock/processLock.js"),DEFAULT_STORAGE_HANDLER={key:function(index){return __awaiter(_this,void 0,void 0,(function(){return __generator(this,(function(_a){throw new Error("Unsupported")}))}))},getItem:function(key){return __awaiter(_this,void 0,void 0,(function(){return __generator(this,(function(_a){throw new Error("Unsupported")}))}))},clear:function(){return __awaiter(_this,void 0,void 0,(function(){return __generator(this,(function(_a){return[2,window.localStorage.clear()]}))}))},removeItem:function(key){return __awaiter(_this,void 0,void 0,(function(){return __generator(this,(function(_a){throw new Error("Unsupported")}))}))},setItem:function(key,value){return __awaiter(_this,void 0,void 0,(function(){return __generator(this,(function(_a){throw new Error("Unsupported")}))}))},keySync:function(index){return window.localStorage.key(index)},getItemSync:function(key){return window.localStorage.getItem(key)},clearSync:function(){return window.localStorage.clear()},removeItemSync:function(key){return window.localStorage.removeItem(key)},setItemSync:function(key,value){return window.localStorage.setItem(key,value)}};function delay(milliseconds){return new Promise((function(resolve){return setTimeout(resolve,milliseconds)}))}function generateRandomString(length){for(var CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",randomstring="",i=0;i<length;i++){randomstring+=CHARS[Math.floor(61*Math.random())]}return randomstring}var SuperTokensLock=function(){function SuperTokensLock(storageHandler){this.acquiredIatSet=new Set,this.storageHandler=void 0,this.id=function getLockId(){return Date.now().toString()+generateRandomString(15)}(),this.acquireLock=this.acquireLock.bind(this),this.releaseLock=this.releaseLock.bind(this),this.releaseLock__private__=this.releaseLock__private__.bind(this),this.waitForSomethingToChange=this.waitForSomethingToChange.bind(this),this.refreshLockWhileAcquired=this.refreshLockWhileAcquired.bind(this),this.storageHandler=storageHandler,void 0===SuperTokensLock.waiters&&(SuperTokensLock.waiters=[])}return SuperTokensLock.prototype.acquireLock=function(lockKey,timeout){return void 0===timeout&&(timeout=5e3),__awaiter(this,void 0,void 0,(function(){var iat,MAX_TIME,STORAGE_KEY,STORAGE,TIMEOUT_KEY,lockObjPostDelay,parsedLockObjPostDelay;return __generator(this,(function(_a){switch(_a.label){case 0:iat=Date.now()+generateRandomString(4),MAX_TIME=Date.now()+timeout,STORAGE_KEY="browser-tabs-lock-key-"+lockKey,STORAGE=void 0===this.storageHandler?DEFAULT_STORAGE_HANDLER:this.storageHandler,_a.label=1;case 1:return Date.now()<MAX_TIME?[4,delay(30)]:[3,8];case 2:return _a.sent(),null!==STORAGE.getItemSync(STORAGE_KEY)?[3,5]:(TIMEOUT_KEY=this.id+"-"+lockKey+"-"+iat,[4,delay(Math.floor(25*Math.random()))]);case 3:return _a.sent(),STORAGE.setItemSync(STORAGE_KEY,JSON.stringify({id:this.id,iat:iat,timeoutKey:TIMEOUT_KEY,timeAcquired:Date.now(),timeRefreshed:Date.now()})),[4,delay(30)];case 4:return _a.sent(),null!==(lockObjPostDelay=STORAGE.getItemSync(STORAGE_KEY))&&(parsedLockObjPostDelay=JSON.parse(lockObjPostDelay)).id===this.id&&parsedLockObjPostDelay.iat===iat?(this.acquiredIatSet.add(iat),this.refreshLockWhileAcquired(STORAGE_KEY,iat),[2,!0]):[3,7];case 5:return SuperTokensLock.lockCorrector(void 0===this.storageHandler?DEFAULT_STORAGE_HANDLER:this.storageHandler),[4,this.waitForSomethingToChange(MAX_TIME)];case 6:_a.sent(),_a.label=7;case 7:return iat=Date.now()+generateRandomString(4),[3,1];case 8:return[2,!1]}}))}))},SuperTokensLock.prototype.refreshLockWhileAcquired=function(storageKey,iat){return __awaiter(this,void 0,void 0,(function(){var _this=this;return __generator(this,(function(_a){return setTimeout((function(){return __awaiter(_this,void 0,void 0,(function(){var STORAGE,lockObj,parsedLockObj;return __generator(this,(function(_a){switch(_a.label){case 0:return[4,processLock_1.default().lock(iat)];case 1:return _a.sent(),this.acquiredIatSet.has(iat)?(STORAGE=void 0===this.storageHandler?DEFAULT_STORAGE_HANDLER:this.storageHandler,null===(lockObj=STORAGE.getItemSync(storageKey))?(processLock_1.default().unlock(iat),[2]):((parsedLockObj=JSON.parse(lockObj)).timeRefreshed=Date.now(),STORAGE.setItemSync(storageKey,JSON.stringify(parsedLockObj)),processLock_1.default().unlock(iat),this.refreshLockWhileAcquired(storageKey,iat),[2])):(processLock_1.default().unlock(iat),[2])}}))}))}),1e3),[2]}))}))},SuperTokensLock.prototype.waitForSomethingToChange=function(MAX_TIME){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){switch(_a.label){case 0:return[4,new Promise((function(resolve){var resolvedCalled=!1,startedAt=Date.now(),removedListeners=!1;function stopWaiting(){if(removedListeners||(window.removeEventListener("storage",stopWaiting),SuperTokensLock.removeFromWaiting(stopWaiting),clearTimeout(timeOutId),removedListeners=!0),!resolvedCalled){resolvedCalled=!0;var timeToWait=50-(Date.now()-startedAt);timeToWait>0?setTimeout(resolve,timeToWait):resolve(null)}}window.addEventListener("storage",stopWaiting),SuperTokensLock.addToWaiting(stopWaiting);var timeOutId=setTimeout(stopWaiting,Math.max(0,MAX_TIME-Date.now()))}))];case 1:return _a.sent(),[2]}}))}))},SuperTokensLock.addToWaiting=function(func){this.removeFromWaiting(func),void 0!==SuperTokensLock.waiters&&SuperTokensLock.waiters.push(func)},SuperTokensLock.removeFromWaiting=function(func){void 0!==SuperTokensLock.waiters&&(SuperTokensLock.waiters=SuperTokensLock.waiters.filter((function(i){return i!==func})))},SuperTokensLock.notifyWaiters=function(){void 0!==SuperTokensLock.waiters&&SuperTokensLock.waiters.slice().forEach((function(i){return i()}))},SuperTokensLock.prototype.releaseLock=function(lockKey){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){switch(_a.label){case 0:return[4,this.releaseLock__private__(lockKey)];case 1:return[2,_a.sent()]}}))}))},SuperTokensLock.prototype.releaseLock__private__=function(lockKey){return __awaiter(this,void 0,void 0,(function(){var STORAGE,STORAGE_KEY,lockObj,parsedlockObj;return __generator(this,(function(_a){switch(_a.label){case 0:return STORAGE=void 0===this.storageHandler?DEFAULT_STORAGE_HANDLER:this.storageHandler,STORAGE_KEY="browser-tabs-lock-key-"+lockKey,null===(lockObj=STORAGE.getItemSync(STORAGE_KEY))?[2]:(parsedlockObj=JSON.parse(lockObj)).id!==this.id?[3,2]:[4,processLock_1.default().lock(parsedlockObj.iat)];case 1:_a.sent(),this.acquiredIatSet.delete(parsedlockObj.iat),STORAGE.removeItemSync(STORAGE_KEY),processLock_1.default().unlock(parsedlockObj.iat),SuperTokensLock.notifyWaiters(),_a.label=2;case 2:return[2]}}))}))},SuperTokensLock.lockCorrector=function(storageHandler){for(var MIN_ALLOWED_TIME=Date.now()-5e3,STORAGE=storageHandler,KEYS=[],currIndex=0;;){var key=STORAGE.keySync(currIndex);if(null===key)break;KEYS.push(key),currIndex++}for(var notifyWaiters=!1,i=0;i<KEYS.length;i++){var LOCK_KEY=KEYS[i];if(LOCK_KEY.includes("browser-tabs-lock-key")){var lockObj=STORAGE.getItemSync(LOCK_KEY);if(null!==lockObj){var parsedlockObj=JSON.parse(lockObj);(void 0===parsedlockObj.timeRefreshed&&parsedlockObj.timeAcquired<MIN_ALLOWED_TIME||void 0!==parsedlockObj.timeRefreshed&&parsedlockObj.timeRefreshed<MIN_ALLOWED_TIME)&&(STORAGE.removeItemSync(LOCK_KEY),notifyWaiters=!0)}}}notifyWaiters&&SuperTokensLock.notifyWaiters()},SuperTokensLock.waiters=void 0,SuperTokensLock}();exports.default=SuperTokensLock},"../supertokens-web-js/node_modules/browser-tabs-lock/processLock.js":function(__unused_webpack_module,exports){Object.defineProperty(exports,"__esModule",{value:!0});var ProcessLocking=function(){function ProcessLocking(){var _this=this;this.locked=new Map,this.addToLocked=function(key,toAdd){var callbacks=_this.locked.get(key);void 0===callbacks?void 0===toAdd?_this.locked.set(key,[]):_this.locked.set(key,[toAdd]):void 0!==toAdd&&(callbacks.unshift(toAdd),_this.locked.set(key,callbacks))},this.isLocked=function(key){return _this.locked.has(key)},this.lock=function(key){return new Promise((function(resolve,reject){_this.isLocked(key)?_this.addToLocked(key,resolve):(_this.addToLocked(key),resolve())}))},this.unlock=function(key){var callbacks=_this.locked.get(key);if(void 0!==callbacks&&0!==callbacks.length){var toCall=callbacks.pop();_this.locked.set(key,callbacks),void 0!==toCall&&setTimeout(toCall,0)}else _this.locked.delete(key)}}return ProcessLocking.getInstance=function(){return void 0===ProcessLocking.instance&&(ProcessLocking.instance=new ProcessLocking),ProcessLocking.instance},ProcessLocking}();exports.default=function getLock(){return ProcessLocking.getInstance()}},"../supertokens-web-js/node_modules/supertokens-js-override/lib/build/getProxyObject.js":function(__unused_webpack_module,exports){var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t},__assign.apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.getProxyObject=void 0,exports.getProxyObject=function getProxyObject(orig){for(var ret=__assign(__assign({},orig),{_call:function(_,__){throw new Error("This function should only be called through the recipe object")}}),_loop_1=function(k){"_call"!==k&&(ret[k]=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return this._call(k,args)})},_i=0,keys_1=Object.keys(ret);_i<keys_1.length;_i++){_loop_1(keys_1[_i])}return ret}},"../supertokens-web-js/node_modules/supertokens-js-override/lib/build/index.js":function(__unused_webpack_module,exports,__webpack_require__){Object.defineProperty(exports,"__esModule",{value:!0}),exports.OverrideableBuilder=void 0;var getProxyObject_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-js-override/lib/build/getProxyObject.js"),OverrideableBuilder=function(){function OverrideableBuilder(originalImplementation){this.layers=[originalImplementation],this.proxies=[]}return OverrideableBuilder.prototype.override=function(overrideFunc){for(var proxy=(0,getProxyObject_1.getProxyObject)(this.layers[0]),layer=overrideFunc(proxy,this),_i=0,_a=Object.keys(this.layers[0]);_i<_a.length;_i++){var key=_a[_i];layer[key]===proxy[key]||"_call"===key?delete layer[key]:void 0===layer[key]&&(layer[key]=null)}return this.layers.push(layer),this.proxies.push(proxy),this},OverrideableBuilder.prototype.build=function(){var _this=this;if(this.result)return this.result;this.result={};for(var _i=0,_a=this.layers;_i<_a.length;_i++)for(var layer=_a[_i],_b=0,_c=Object.keys(layer);_b<_c.length;_b++){var key=_c[_b],override=layer[key];void 0!==override&&(this.result[key]=null===override?void 0:"function"==typeof override?override.bind(this.result):override)}for(var _loop_1=function(proxyInd){this_1.proxies[proxyInd]._call=function(fname,args){for(var i=proxyInd;i>=0;--i){var func=_this.layers[i][fname];if(null!=func)return func.bind(_this.result).apply(void 0,args)}}},this_1=this,proxyInd=0;proxyInd<this.proxies.length;++proxyInd)_loop_1(proxyInd);return this.result},OverrideableBuilder}();exports.OverrideableBuilder=OverrideableBuilder,exports.default=OverrideableBuilder},"../supertokens-web-js/node_modules/supertokens-website/index.js":function(__unused_webpack_module,exports,__webpack_require__){exports.__esModule=!0,function __export(m){for(var p in m)exports.hasOwnProperty(p)||(exports[p]=m[p])}(__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/index.js"))},"../supertokens-web-js/node_modules/supertokens-website/lib/build/axios.js":function(__unused_webpack_module,exports,__webpack_require__){var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t},__assign.apply(this,arguments)},__awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.responseErrorInterceptor=exports.responseInterceptor=exports.interceptorFunctionRequestFulfilled=void 0;var axiosError_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/axiosError.js"),fetch_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/fetch.js"),processState_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/processState.js"),windowHandler_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/utils/windowHandler/index.js"),logger_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/logger.js");function getUrlFromConfig(config){var url=void 0===config.url?"":config.url,baseURL=config.baseURL;return void 0!==baseURL&&(url="/"===url.charAt(0)&&"/"===baseURL.charAt(baseURL.length-1)?baseURL+url.substr(1):"/"!==url.charAt(0)&&"/"!==baseURL.charAt(baseURL.length-1)?baseURL+"/"+url:baseURL+url),url}exports.interceptorFunctionRequestFulfilled=function interceptorFunctionRequestFulfilled(config){return __awaiter(this,void 0,void 0,(function(){var url,doNotDoInterception,preRequestLSS,configWithAntiCsrf,antiCsrfToken,transferMethod;return __generator(this,(function(_a){switch(_a.label){case 0:(0,logger_1.logDebugMessage)("interceptorFunctionRequestFulfilled: started axios interception"),url=getUrlFromConfig(config),doNotDoInterception=!1;try{doNotDoInterception="string"==typeof url&&!fetch_1.default.recipeImpl.shouldDoInterceptionBasedOnUrl(url,fetch_1.default.config.apiDomain,fetch_1.default.config.sessionTokenBackendDomain)}catch(err){if("Please provide a valid domain name"!==err.message)throw err;(0,logger_1.logDebugMessage)("interceptorFunctionRequestFulfilled: Trying shouldDoInterceptionBasedOnUrl with location.origin"),doNotDoInterception=!fetch_1.default.recipeImpl.shouldDoInterceptionBasedOnUrl(windowHandler_1.default.getReferenceOrThrow().windowHandler.location.getOrigin(),fetch_1.default.config.apiDomain,fetch_1.default.config.sessionTokenBackendDomain)}return(0,logger_1.logDebugMessage)("interceptorFunctionRequestFulfilled: Value of doNotDoInterception: "+doNotDoInterception),doNotDoInterception?((0,logger_1.logDebugMessage)("interceptorFunctionRequestFulfilled: Returning config unchanged"),[2,config]):((0,logger_1.logDebugMessage)("interceptorFunctionRequestFulfilled: Modifying config"),processState_1.ProcessState.getInstance().addState(processState_1.PROCESS_STATE.CALLING_INTERCEPTION_REQUEST),[4,(0,fetch_1.getLocalSessionState)(!0)]);case 1:return preRequestLSS=_a.sent(),configWithAntiCsrf=config,"EXISTS"!==preRequestLSS.status?[3,3]:[4,fetch_1.AntiCsrfToken.getToken(preRequestLSS.lastAccessTokenUpdate)];case 2:void 0!==(antiCsrfToken=_a.sent())&&((0,logger_1.logDebugMessage)("interceptorFunctionRequestFulfilled: Adding anti-csrf token to request"),configWithAntiCsrf=__assign(__assign({},configWithAntiCsrf),{headers:void 0===configWithAntiCsrf?{"anti-csrf":antiCsrfToken}:__assign(__assign({},configWithAntiCsrf.headers),{"anti-csrf":antiCsrfToken})})),_a.label=3;case 3:return fetch_1.default.config.autoAddCredentials&&void 0===configWithAntiCsrf.withCredentials&&((0,logger_1.logDebugMessage)("interceptorFunctionRequestFulfilled: Adding credentials include"),configWithAntiCsrf=__assign(__assign({},configWithAntiCsrf),{withCredentials:!0})),(0,logger_1.logDebugMessage)("interceptorFunctionRequestFulfilled: Adding rid header: anti-csrf (it may be overriden by the user's provided rid)"),configWithAntiCsrf=__assign(__assign({},configWithAntiCsrf),{headers:void 0===configWithAntiCsrf?{rid:"anti-csrf"}:__assign({rid:"anti-csrf"},configWithAntiCsrf.headers)}),transferMethod=fetch_1.default.config.tokenTransferMethod,(0,logger_1.logDebugMessage)("interceptorFunctionRequestFulfilled: Adding st-auth-mode header: "+transferMethod),configWithAntiCsrf.headers["st-auth-mode"]=transferMethod,[4,removeAuthHeaderIfMatchesLocalToken(configWithAntiCsrf)];case 4:return[4,setAuthorizationHeaderIfRequired(configWithAntiCsrf=_a.sent())];case 5:return _a.sent(),(0,logger_1.logDebugMessage)("interceptorFunctionRequestFulfilled: returning modified config"),[2,configWithAntiCsrf]}}))}))},exports.responseInterceptor=function responseInterceptor(axiosInstance){var _this=this;return function(response){return __awaiter(_this,void 0,void 0,(function(){var doNotDoInterception,url,preRequestLSS,config,_a;return __generator(this,(function(_b){switch(_b.label){case 0:doNotDoInterception=!1,_b.label=1;case 1:if(_b.trys.push([1,,8,14]),!fetch_1.default.initCalled)throw new Error("init function not called");(0,logger_1.logDebugMessage)("responseInterceptor: started"),(0,logger_1.logDebugMessage)("responseInterceptor: already intercepted: "+response.headers["x-supertokens-xhr-intercepted"]),url=getUrlFromConfig(response.config);try{doNotDoInterception="string"==typeof url&&!fetch_1.default.recipeImpl.shouldDoInterceptionBasedOnUrl(url,fetch_1.default.config.apiDomain,fetch_1.default.config.sessionTokenBackendDomain)||!!response.headers["x-supertokens-xhr-intercepted"]}catch(err){if("Please provide a valid domain name"!==err.message)throw err;(0,logger_1.logDebugMessage)("responseInterceptor: Trying shouldDoInterceptionBasedOnUrl with location.origin"),doNotDoInterception=!fetch_1.default.recipeImpl.shouldDoInterceptionBasedOnUrl(windowHandler_1.default.getReferenceOrThrow().windowHandler.location.getOrigin(),fetch_1.default.config.apiDomain,fetch_1.default.config.sessionTokenBackendDomain)||!!response.headers["x-supertokens-xhr-intercepted"]}return(0,logger_1.logDebugMessage)("responseInterceptor: Value of doNotDoInterception: "+doNotDoInterception),doNotDoInterception?((0,logger_1.logDebugMessage)("responseInterceptor: Returning without interception"),[2,response]):((0,logger_1.logDebugMessage)("responseInterceptor: Interception started"),processState_1.ProcessState.getInstance().addState(processState_1.PROCESS_STATE.CALLING_INTERCEPTION_RESPONSE),[4,(0,fetch_1.getLocalSessionState)(!1)]);case 2:return preRequestLSS=_b.sent(),[4,saveTokensFromHeaders(response)];case 3:return _b.sent(),(0,fetch_1.fireSessionUpdateEventsIfNecessary)("EXISTS"===preRequestLSS.status,response.status,response.headers["front-token"]),response.status!==fetch_1.default.config.sessionExpiredStatusCode?[3,4]:((0,logger_1.logDebugMessage)("responseInterceptor: Status code is: "+response.status),config=response.config,[2,AuthHttpRequest.doRequest((function(config){return axiosInstance(config)}),config,url,response,void 0,!0)]);case 4:return response.status!==fetch_1.default.config.invalidClaimStatusCode?[3,6]:[4,(0,fetch_1.onInvalidClaimResponse)(response)];case 5:_b.sent(),_b.label=6;case 6:return[2,response];case 7:return[3,14];case 8:return(_a=!doNotDoInterception)?[4,(0,fetch_1.getLocalSessionState)(!0)]:[3,10];case 9:_a=!("EXISTS"===_b.sent().status),_b.label=10;case 10:return _a?((0,logger_1.logDebugMessage)("responseInterceptor: local session doesn't exist, so removing anti-csrf and sFrontToken"),[4,fetch_1.AntiCsrfToken.removeToken()]):[3,13];case 11:return _b.sent(),[4,fetch_1.FrontToken.removeToken()];case 12:_b.sent(),_b.label=13;case 13:return[7];case 14:return[2]}}))}))}},exports.responseErrorInterceptor=function responseErrorInterceptor(axiosInstance){var _this=this;return function(error){return __awaiter(_this,void 0,void 0,(function(){var config;return __generator(this,(function(_a){switch(_a.label){case 0:if((0,logger_1.logDebugMessage)("responseErrorInterceptor: called"),(0,logger_1.logDebugMessage)("responseErrorInterceptor: already intercepted: "+(error.response&&error.response.headers["x-supertokens-xhr-intercepted"])),error.response.headers["x-supertokens-xhr-intercepted"])throw error;return void 0===error.response||error.response.status!==fetch_1.default.config.sessionExpiredStatusCode?[3,1]:((0,logger_1.logDebugMessage)("responseErrorInterceptor: Status code is: "+error.response.status),config=error.config,[2,AuthHttpRequest.doRequest((function(config){return axiosInstance(config)}),config,getUrlFromConfig(config),void 0,error,!0)]);case 1:return void 0===error.response||error.response.status!==fetch_1.default.config.invalidClaimStatusCode?[3,3]:[4,(0,fetch_1.onInvalidClaimResponse)(error.response)];case 2:_a.sent(),_a.label=3;case 3:throw error}}))}))}};var AuthHttpRequest=function(){function AuthHttpRequest(){}var _a;return _a=AuthHttpRequest,AuthHttpRequest.doRequest=function(httpCall,config,url,prevResponse,prevError,viaInterceptor){return void 0===viaInterceptor&&(viaInterceptor=!1),__awaiter(void 0,void 0,void 0,(function(){var doNotDoInterception,returnObj,preRequestLSS,configWithAntiCsrf,antiCsrfToken,transferMethod,localPrevError,localPrevResponse,_b,_c,err_1,response,refreshResult,_d;return __generator(_a,(function(_e){switch(_e.label){case 0:if(!fetch_1.default.initCalled)throw Error("init function not called");(0,logger_1.logDebugMessage)("doRequest: called"),doNotDoInterception=!1;try{doNotDoInterception="string"==typeof url&&!fetch_1.default.recipeImpl.shouldDoInterceptionBasedOnUrl(url,fetch_1.default.config.apiDomain,fetch_1.default.config.sessionTokenBackendDomain)&&viaInterceptor}catch(err){if("Please provide a valid domain name"!==err.message)throw err;(0,logger_1.logDebugMessage)("doRequest: Trying shouldDoInterceptionBasedOnUrl with location.origin"),doNotDoInterception=!fetch_1.default.recipeImpl.shouldDoInterceptionBasedOnUrl(windowHandler_1.default.getReferenceOrThrow().windowHandler.location.getOrigin(),fetch_1.default.config.apiDomain,fetch_1.default.config.sessionTokenBackendDomain)&&viaInterceptor}if((0,logger_1.logDebugMessage)("doRequest: Value of doNotDoInterception: "+doNotDoInterception),!doNotDoInterception)return[3,2];if((0,logger_1.logDebugMessage)("doRequest: Returning without interception"),void 0!==prevError)throw prevError;return void 0!==prevResponse?[2,prevResponse]:[4,httpCall(config)];case 1:return[2,_e.sent()];case 2:return(0,logger_1.logDebugMessage)("doRequest: Interception started"),[4,removeAuthHeaderIfMatchesLocalToken(config)];case 3:config=_e.sent(),_e.label=4;case 4:_e.trys.push([4,,40,45]),returnObj=void 0,_e.label=5;case 5:return[4,(0,fetch_1.getLocalSessionState)(!0)];case 6:return preRequestLSS=_e.sent(),configWithAntiCsrf=config,"EXISTS"!==preRequestLSS.status?[3,8]:[4,fetch_1.AntiCsrfToken.getToken(preRequestLSS.lastAccessTokenUpdate)];case 7:void 0!==(antiCsrfToken=_e.sent())&&((0,logger_1.logDebugMessage)("doRequest: Adding anti-csrf token to request"),configWithAntiCsrf=__assign(__assign({},configWithAntiCsrf),{headers:void 0===configWithAntiCsrf?{"anti-csrf":antiCsrfToken}:__assign(__assign({},configWithAntiCsrf.headers),{"anti-csrf":antiCsrfToken})})),_e.label=8;case 8:return fetch_1.default.config.autoAddCredentials&&void 0===configWithAntiCsrf.withCredentials&&((0,logger_1.logDebugMessage)("doRequest: Adding credentials include"),configWithAntiCsrf=__assign(__assign({},configWithAntiCsrf),{withCredentials:!0})),(0,logger_1.logDebugMessage)("doRequest: Adding rid header: anti-csrf (May get overriden by user's rid)"),configWithAntiCsrf=__assign(__assign({},configWithAntiCsrf),{headers:void 0===configWithAntiCsrf?{rid:"anti-csrf"}:__assign({rid:"anti-csrf"},configWithAntiCsrf.headers)}),transferMethod=fetch_1.default.config.tokenTransferMethod,(0,logger_1.logDebugMessage)("doRequest: Adding st-auth-mode header: "+transferMethod),configWithAntiCsrf.headers["st-auth-mode"]=transferMethod,[4,setAuthorizationHeaderIfRequired(configWithAntiCsrf)];case 9:_e.sent(),_e.label=10;case 10:if(_e.trys.push([10,25,,38]),localPrevError=prevError,localPrevResponse=prevResponse,prevError=void 0,prevResponse=void 0,void 0!==localPrevError)throw(0,logger_1.logDebugMessage)("doRequest: Not making call because localPrevError is not undefined"),localPrevError;return void 0!==localPrevResponse?(0,logger_1.logDebugMessage)("doRequest: Not making call because localPrevResponse is not undefined"):(0,logger_1.logDebugMessage)("doRequest: Making user's http call"),void 0!==localPrevResponse?[3,12]:[4,httpCall(configWithAntiCsrf)];case 11:return _b=_e.sent(),[3,13];case 12:_b=localPrevResponse,_e.label=13;case 13:return response=_b,(0,logger_1.logDebugMessage)("doRequest: User's http call ended"),[4,saveTokensFromHeaders(response)];case 14:return _e.sent(),(0,fetch_1.fireSessionUpdateEventsIfNecessary)("EXISTS"===preRequestLSS.status,response.status,response.headers["front-token"]),response.status!==fetch_1.default.config.sessionExpiredStatusCode?[3,21]:((0,logger_1.logDebugMessage)("doRequest: Status code is: "+response.status),[4,(0,fetch_1.onUnauthorisedResponse)(preRequestLSS)]);case 15:return"RETRY"===(refreshResult=_e.sent()).result?[3,20]:((0,logger_1.logDebugMessage)("doRequest: Not retrying original request"),refreshResult.error?[4,(0,axiosError_1.createAxiosErrorFromFetchResp)(refreshResult.error)]:[3,17]);case 16:return _c=_e.sent(),[3,19];case 17:return[4,(0,axiosError_1.createAxiosErrorFromAxiosResp)(response)];case 18:_c=_e.sent(),_e.label=19;case 19:return returnObj=_c,[3,39];case 20:return(0,logger_1.logDebugMessage)("doRequest: Retrying original request"),[3,24];case 21:return response.status!==fetch_1.default.config.invalidClaimStatusCode?[3,23]:[4,(0,fetch_1.onInvalidClaimResponse)(response)];case 22:_e.sent(),_e.label=23;case 23:return[2,response];case 24:return[3,38];case 25:return err_1=_e.sent(),void 0===(response=err_1.response)?[3,36]:[4,saveTokensFromHeaders(response)];case 26:return _e.sent(),(0,fetch_1.fireSessionUpdateEventsIfNecessary)("EXISTS"===preRequestLSS.status,response.status,response.headers["front-token"]),response.status!==fetch_1.default.config.sessionExpiredStatusCode?[3,32]:((0,logger_1.logDebugMessage)("doRequest: Status code is: "+response.status),[4,(0,fetch_1.onUnauthorisedResponse)(preRequestLSS)]);case 27:return"RETRY"===(refreshResult=_e.sent()).result?[3,31]:((0,logger_1.logDebugMessage)("doRequest: Not retrying original request"),void 0===refreshResult.error?[3,29]:[4,(0,axiosError_1.createAxiosErrorFromFetchResp)(refreshResult.error)]);case 28:return _d=_e.sent(),[3,30];case 29:_d=err_1,_e.label=30;case 30:return returnObj=_d,[3,39];case 31:return(0,logger_1.logDebugMessage)("doRequest: Retrying original request"),[3,35];case 32:return response.status!==fetch_1.default.config.invalidClaimStatusCode?[3,34]:[4,(0,fetch_1.onInvalidClaimResponse)(response)];case 33:_e.sent(),_e.label=34;case 34:throw err_1;case 35:return[3,37];case 36:throw err_1;case 37:return[3,38];case 38:return[3,5];case 39:throw returnObj;case 40:return[4,(0,fetch_1.getLocalSessionState)(!1)];case 41:return"NOT_EXISTS"!==_e.sent().status?[3,44]:((0,logger_1.logDebugMessage)("doRequest: local session doesn't exist, so removing anti-csrf and sFrontToken"),[4,fetch_1.AntiCsrfToken.removeToken()]);case 42:return _e.sent(),[4,fetch_1.FrontToken.removeToken()];case 43:_e.sent(),_e.label=44;case 44:return[7];case 45:return[2]}}))}))},AuthHttpRequest}();function setAuthorizationHeaderIfRequired(requestConfig){return __awaiter(this,void 0,void 0,(function(){var accessToken,refreshToken;return __generator(this,(function(_b){switch(_b.label){case 0:return void 0===requestConfig.headers&&(requestConfig.headers={}),(0,logger_1.logDebugMessage)("setAuthorizationHeaderIfRequired: adding existing tokens as header"),[4,(0,fetch_1.getTokenForHeaderAuth)("access")];case 1:return accessToken=_b.sent(),[4,(0,fetch_1.getTokenForHeaderAuth)("refresh")];case 2:return refreshToken=_b.sent(),void 0!==accessToken&&void 0!==refreshToken?void 0!==requestConfig.headers.Authorization||void 0!==requestConfig.headers.authorization?(0,logger_1.logDebugMessage)("setAuthorizationHeaderIfRequired: Authorization header defined by the user, not adding"):((0,logger_1.logDebugMessage)("setAuthorizationHeaderIfRequired: added authorization header"),requestConfig.headers=__assign(__assign({},requestConfig.headers),{Authorization:"Bearer ".concat(accessToken)}),requestConfig.__supertokensAddedAuthHeader=!0):(0,logger_1.logDebugMessage)("setAuthorizationHeaderIfRequired: token for header based auth not found"),[2]}}))}))}function saveTokensFromHeaders(response){return __awaiter(this,void 0,void 0,(function(){var refreshToken,accessToken,frontToken,antiCsrfToken,tok;return __generator(this,(function(_b){switch(_b.label){case 0:return(0,logger_1.logDebugMessage)("saveTokensFromHeaders: Saving updated tokens from the response"),void 0===(refreshToken=response.headers["st-refresh-token"])?[3,2]:((0,logger_1.logDebugMessage)("saveTokensFromHeaders: saving new refresh token"),[4,(0,fetch_1.setToken)("refresh",refreshToken)]);case 1:_b.sent(),_b.label=2;case 2:return void 0===(accessToken=response.headers["st-access-token"])?[3,4]:((0,logger_1.logDebugMessage)("saveTokensFromHeaders: saving new access token"),[4,(0,fetch_1.setToken)("access",accessToken)]);case 3:_b.sent(),_b.label=4;case 4:return void 0===(frontToken=response.headers["front-token"])?[3,6]:((0,logger_1.logDebugMessage)("doRequest: Setting sFrontToken: "+frontToken),[4,fetch_1.FrontToken.setItem(frontToken)]);case 5:_b.sent(),_b.label=6;case 6:return void 0===(antiCsrfToken=response.headers["anti-csrf"])?[3,9]:[4,(0,fetch_1.getLocalSessionState)(!0)];case 7:return"EXISTS"!==(tok=_b.sent()).status?[3,9]:((0,logger_1.logDebugMessage)("doRequest: Setting anti-csrf token"),[4,fetch_1.AntiCsrfToken.setItem(tok.lastAccessTokenUpdate,antiCsrfToken)]);case 8:_b.sent(),_b.label=9;case 9:return[2]}}))}))}function removeAuthHeaderIfMatchesLocalToken(config){return __awaiter(this,void 0,void 0,(function(){var accessToken,refreshToken,authHeader,res;return __generator(this,(function(_b){switch(_b.label){case 0:return[4,(0,fetch_1.getTokenForHeaderAuth)("access")];case 1:return accessToken=_b.sent(),[4,(0,fetch_1.getTokenForHeaderAuth)("refresh")];case 2:return refreshToken=_b.sent(),authHeader=config.headers.Authorization||config.headers.authorization,void 0===accessToken||void 0===refreshToken||authHeader!=="Bearer ".concat(accessToken)&&!("__supertokensAddedAuthHeader"in config)?[2,config]:((0,logger_1.logDebugMessage)("removeAuthHeaderIfMatchesLocalToken: Removing Authorization from user provided headers because it contains our access token"),delete(res=__assign(__assign({},config),{headers:__assign({},config.headers)})).headers.authorization,delete res.headers.Authorization,[2,res])}}))}))}exports.default=AuthHttpRequest},"../supertokens-web-js/node_modules/supertokens-website/lib/build/axiosError.js":function(__unused_webpack_module,exports){var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}};function enhanceAxiosError(error,config,code,request,response){return error.config=config,code&&(error.code=code),error.request=request,error.response=response,error.isAxiosError=!0,error.toJSON=function toJSON(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},error}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createAxiosErrorFromAxiosResp=exports.createAxiosErrorFromFetchResp=void 0,exports.createAxiosErrorFromFetchResp=function createAxiosErrorFromFetchResp(response){return __awaiter(this,void 0,void 0,(function(){var config,contentType,data,axiosResponse;return __generator(this,(function(_b){switch(_b.label){case 0:if(config={url:response.url,headers:response.headers},null!==(contentType=response.headers.get("content-type")))return[3,5];_b.label=1;case 1:return _b.trys.push([1,3,,4]),[4,response.text()];case 2:return data=_b.sent(),[3,4];case 3:return _b.sent(),data="",[3,4];case 4:return[3,11];case 5:return contentType.includes("application/json")?[4,response.json()]:[3,7];case 6:return data=_b.sent(),[3,11];case 7:return contentType.includes("text/")?[4,response.text()]:[3,9];case 8:return data=_b.sent(),[3,11];case 9:return[4,response.blob()];case 10:data=_b.sent(),_b.label=11;case 11:return axiosResponse={data:data,status:response.status,statusText:response.statusText,headers:response.headers,config:config,request:void 0},[2,enhanceAxiosError(new Error("Request failed with status code "+response.status),config,void 0,void 0,axiosResponse)]}}))}))},exports.createAxiosErrorFromAxiosResp=function createAxiosErrorFromAxiosResp(response){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){return[2,enhanceAxiosError(new Error("Request failed with status code "+response.status),response.config,void 0,response.request,response)]}))}))}},"../supertokens-web-js/node_modules/supertokens-website/lib/build/claims/booleanClaim.js":function(__unused_webpack_module,exports,__webpack_require__){var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])},extendStatics(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__assign=this&&this.__assign||function(){return __assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t},__assign.apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.BooleanClaim=void 0;var BooleanClaim=function(_super){function BooleanClaim(config){var _this=_super.call(this,config)||this;return _this.validators=__assign(__assign({},_this.validators),{isTrue:function(maxAge){return _this.validators.hasValue(!0,maxAge)},isFalse:function(maxAge){return _this.validators.hasValue(!1,maxAge)}}),_this}return __extends(BooleanClaim,_super),BooleanClaim}(__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/claims/primitiveClaim.js").PrimitiveClaim);exports.BooleanClaim=BooleanClaim},"../supertokens-web-js/node_modules/supertokens-website/lib/build/claims/primitiveArrayClaim.js":function(__unused_webpack_module,exports){var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.PrimitiveArrayClaim=void 0;var PrimitiveArrayClaim=function(){function PrimitiveArrayClaim(config){var _this=this;this.validators={includes:function(val,maxAgeInSeconds,id){return void 0===maxAgeInSeconds&&(maxAgeInSeconds=_this.defaultMaxAgeInSeconds),{id:void 0!==id?id:_this.id,refresh:function(ctx){return _this.refresh(ctx)},shouldRefresh:function(payload,ctx){return void 0===_this.getValueFromPayload(payload,ctx)||void 0!==maxAgeInSeconds&&payload[_this.id].t<Date.now()-1e3*maxAgeInSeconds},validate:function(payload,ctx){return __awaiter(_this,void 0,void 0,(function(){var claimVal,ageInSeconds;return __generator(this,(function(_a){return void 0===(claimVal=this.getValueFromPayload(payload,ctx))?[2,{isValid:!1,reason:{message:"value does not exist",expectedToInclude:val,actualValue:claimVal}}]:(ageInSeconds=(Date.now()-this.getLastFetchedTime(payload,ctx))/1e3,void 0!==maxAgeInSeconds&&ageInSeconds>maxAgeInSeconds?[2,{isValid:!1,reason:{message:"expired",ageInSeconds:ageInSeconds,maxAgeInSeconds:maxAgeInSeconds}}]:claimVal.includes(val)?[2,{isValid:!0}]:[2,{isValid:!1,reason:{message:"wrong value",expectedToInclude:val,actualValue:claimVal}}])}))}))}}},excludes:function(val,maxAgeInSeconds,id){return void 0===maxAgeInSeconds&&(maxAgeInSeconds=_this.defaultMaxAgeInSeconds),{id:void 0!==id?id:_this.id,refresh:function(ctx){return _this.refresh(ctx)},shouldRefresh:function(payload,ctx){return void 0===_this.getValueFromPayload(payload,ctx)||void 0!==maxAgeInSeconds&&payload[_this.id].t<Date.now()-1e3*maxAgeInSeconds},validate:function(payload,ctx){return __awaiter(_this,void 0,void 0,(function(){var claimVal,ageInSeconds;return __generator(this,(function(_a){return void 0===(claimVal=this.getValueFromPayload(payload,ctx))?[2,{isValid:!1,reason:{message:"value does not exist",expectedToNotInclude:val,actualValue:claimVal}}]:(ageInSeconds=(Date.now()-this.getLastFetchedTime(payload,ctx))/1e3,void 0!==maxAgeInSeconds&&ageInSeconds>maxAgeInSeconds?[2,{isValid:!1,reason:{message:"expired",ageInSeconds:ageInSeconds,maxAgeInSeconds:maxAgeInSeconds}}]:claimVal.includes(val)?[2,{isValid:!1,reason:{message:"wrong value",expectedToNotInclude:val,actualValue:claimVal}}]:[2,{isValid:!0}])}))}))}}},includesAll:function(val,maxAgeInSeconds,id){return void 0===maxAgeInSeconds&&(maxAgeInSeconds=_this.defaultMaxAgeInSeconds),{id:void 0!==id?id:_this.id,refresh:function(ctx){return _this.refresh(ctx)},shouldRefresh:function(payload,ctx){return void 0===_this.getValueFromPayload(payload,ctx)||void 0!==maxAgeInSeconds&&payload[_this.id].t<Date.now()-1e3*maxAgeInSeconds},validate:function(payload,ctx){return __awaiter(_this,void 0,void 0,(function(){var claimVal,ageInSeconds,claimSet,isValid;return __generator(this,(function(_a){return void 0===(claimVal=this.getValueFromPayload(payload,ctx))?[2,{isValid:!1,reason:{message:"value does not exist",expectedToInclude:val,actualValue:claimVal}}]:(ageInSeconds=(Date.now()-this.getLastFetchedTime(payload,ctx))/1e3,void 0!==maxAgeInSeconds&&ageInSeconds>maxAgeInSeconds?[2,{isValid:!1,reason:{message:"expired",ageInSeconds:ageInSeconds,maxAgeInSeconds:maxAgeInSeconds}}]:(claimSet=new Set(claimVal),[2,(isValid=val.every((function(v){return claimSet.has(v)})))?{isValid:isValid}:{isValid:isValid,reason:{message:"wrong value",expectedToInclude:val,actualValue:claimVal}}]))}))}))}}},includesAny:function(val,maxAgeInSeconds,id){return void 0===maxAgeInSeconds&&(maxAgeInSeconds=_this.defaultMaxAgeInSeconds),{id:void 0!==id?id:_this.id,refresh:function(ctx){return _this.refresh(ctx)},shouldRefresh:function(payload,ctx){return void 0===_this.getValueFromPayload(payload,ctx)||void 0!==maxAgeInSeconds&&payload[_this.id].t<Date.now()-1e3*maxAgeInSeconds},validate:function(payload,ctx){return __awaiter(_this,void 0,void 0,(function(){var claimVal,ageInSeconds,claimSet,isValid;return __generator(this,(function(_a){return void 0===(claimVal=this.getValueFromPayload(payload,ctx))?[2,{isValid:!1,reason:{message:"value does not exist",expectedToInclude:val,actualValue:claimVal}}]:(ageInSeconds=(Date.now()-this.getLastFetchedTime(payload,ctx))/1e3,void 0!==maxAgeInSeconds&&ageInSeconds>maxAgeInSeconds?[2,{isValid:!1,reason:{message:"expired",ageInSeconds:ageInSeconds,maxAgeInSeconds:maxAgeInSeconds}}]:(claimSet=new Set(claimVal),[2,(isValid=val.some((function(v){return claimSet.has(v)})))?{isValid:isValid}:{isValid:isValid,reason:{message:"wrong value",expectedToIncludeAtLeastOneOf:val,actualValue:claimVal}}]))}))}))}}},excludesAll:function(val,maxAgeInSeconds,id){return void 0===maxAgeInSeconds&&(maxAgeInSeconds=_this.defaultMaxAgeInSeconds),{id:void 0!==id?id:_this.id,refresh:function(ctx){return _this.refresh(ctx)},shouldRefresh:function(payload,ctx){return void 0===_this.getValueFromPayload(payload,ctx)||void 0!==maxAgeInSeconds&&payload[_this.id].t<Date.now()-1e3*maxAgeInSeconds},validate:function(payload,ctx){return __awaiter(_this,void 0,void 0,(function(){var claimVal,ageInSeconds,claimSet,isValid;return __generator(this,(function(_a){return void 0===(claimVal=this.getValueFromPayload(payload,ctx))?[2,{isValid:!1,reason:{message:"value does not exist",expectedToNotInclude:val,actualValue:claimVal}}]:(ageInSeconds=(Date.now()-this.getLastFetchedTime(payload,ctx))/1e3,void 0!==maxAgeInSeconds&&ageInSeconds>maxAgeInSeconds?[2,{isValid:!1,reason:{message:"expired",ageInSeconds:ageInSeconds,maxAgeInSeconds:maxAgeInSeconds}}]:(claimSet=new Set(claimVal),[2,(isValid=val.every((function(v){return!claimSet.has(v)})))?{isValid:isValid}:{isValid:isValid,reason:{message:"wrong value",expectedToNotInclude:val,actualValue:claimVal}}]))}))}))}}}},this.id=config.id,this.refresh=config.refresh,this.defaultMaxAgeInSeconds=config.defaultMaxAgeInSeconds}return PrimitiveArrayClaim.prototype.getValueFromPayload=function(payload,_userContext){return void 0!==payload[this.id]?payload[this.id].v:void 0},PrimitiveArrayClaim.prototype.getLastFetchedTime=function(payload,_userContext){return void 0!==payload[this.id]?payload[this.id].t:void 0},PrimitiveArrayClaim}();exports.PrimitiveArrayClaim=PrimitiveArrayClaim},"../supertokens-web-js/node_modules/supertokens-website/lib/build/claims/primitiveClaim.js":function(__unused_webpack_module,exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.PrimitiveClaim=void 0;var PrimitiveClaim=function(){function PrimitiveClaim(config){var _this=this;this.validators={hasValue:function(val,maxAgeInSeconds,id){return void 0===maxAgeInSeconds&&(maxAgeInSeconds=_this.defaultMaxAgeInSeconds),{id:void 0!==id?id:_this.id,refresh:function(ctx){return _this.refresh(ctx)},shouldRefresh:function(payload,ctx){return void 0===_this.getValueFromPayload(payload,ctx)||void 0!==maxAgeInSeconds&&payload[_this.id].t<Date.now()-1e3*maxAgeInSeconds},validate:function(payload,ctx){var claimVal=_this.getValueFromPayload(payload,ctx);if(void 0===claimVal)return{isValid:!1,reason:{message:"value does not exist",expectedValue:val,actualValue:claimVal}};var ageInSeconds=(Date.now()-_this.getLastFetchedTime(payload,ctx))/1e3;return void 0!==maxAgeInSeconds&&ageInSeconds>maxAgeInSeconds?{isValid:!1,reason:{message:"expired",ageInSeconds:ageInSeconds,maxAgeInSeconds:maxAgeInSeconds}}:claimVal!==val?{isValid:!1,reason:{message:"wrong value",expectedValue:val,actualValue:claimVal}}:{isValid:!0}}}}},this.id=config.id,this.refresh=config.refresh,this.defaultMaxAgeInSeconds=config.defaultMaxAgeInSeconds}return PrimitiveClaim.prototype.getValueFromPayload=function(payload,_userContext){return void 0!==payload[this.id]?payload[this.id].v:void 0},PrimitiveClaim.prototype.getLastFetchedTime=function(payload,_userContext){return void 0!==payload[this.id]?payload[this.id].t:void 0},PrimitiveClaim}();exports.PrimitiveClaim=PrimitiveClaim},"../supertokens-web-js/node_modules/supertokens-website/lib/build/error.js":function(__unused_webpack_module,exports){var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])},extendStatics(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0}),exports.STGeneralError=void 0;var STGeneralError=function(_super){function STGeneralError(message){var _this=_super.call(this,message)||this;return _this.isSuperTokensGeneralError=!0,_this}return __extends(STGeneralError,_super),STGeneralError.isThisError=function(err){return!0===err.isSuperTokensGeneralError},STGeneralError}(Error);exports.STGeneralError=STGeneralError},"../supertokens-web-js/node_modules/supertokens-website/lib/build/fetch.js":function(__unused_webpack_module,exports,__webpack_require__){var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t},__assign.apply(this,arguments)},__awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.fireSessionUpdateEventsIfNecessary=exports.setFrontToken=exports.getFrontToken=exports.setAntiCSRF=exports.saveLastAccessTokenUpdate=exports.getTokenForHeaderAuth=exports.setToken=exports.getStorageNameForToken=exports.getLocalSessionState=exports.onInvalidClaimResponse=exports.onTokenUpdate=exports.onUnauthorisedResponse=exports.FrontToken=exports.AntiCsrfToken=void 0;var processState_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/processState.js"),version_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/version.js"),cookieHandler_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/utils/cookieHandler/index.js"),windowHandler_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/utils/windowHandler/index.js"),lockFactory_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/utils/lockFactory/index.js"),logger_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/logger.js"),AntiCsrfToken=function(){function AntiCsrfToken(){}return AntiCsrfToken.getToken=function(associatedAccessTokenUpdate){return __awaiter(this,void 0,void 0,(function(){var antiCsrf;return __generator(this,(function(_a){switch(_a.label){case 0:return(0,logger_1.logDebugMessage)("AntiCsrfToken.getToken: called"),void 0===associatedAccessTokenUpdate?(AntiCsrfToken.tokenInfo=void 0,(0,logger_1.logDebugMessage)("AntiCsrfToken.getToken: returning undefined"),[2,void 0]):void 0!==AntiCsrfToken.tokenInfo?[3,2]:[4,getAntiCSRFToken()];case 1:return null===(antiCsrf=_a.sent())?((0,logger_1.logDebugMessage)("AntiCsrfToken.getToken: returning undefined"),[2,void 0]):(AntiCsrfToken.tokenInfo={antiCsrf:antiCsrf,associatedAccessTokenUpdate:associatedAccessTokenUpdate},[3,4]);case 2:return AntiCsrfToken.tokenInfo.associatedAccessTokenUpdate===associatedAccessTokenUpdate?[3,4]:(AntiCsrfToken.tokenInfo=void 0,[4,AntiCsrfToken.getToken(associatedAccessTokenUpdate)]);case 3:return[2,_a.sent()];case 4:return(0,logger_1.logDebugMessage)("AntiCsrfToken.getToken: returning: "+AntiCsrfToken.tokenInfo.antiCsrf),[2,AntiCsrfToken.tokenInfo.antiCsrf]}}))}))},AntiCsrfToken.removeToken=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){switch(_a.label){case 0:return(0,logger_1.logDebugMessage)("AntiCsrfToken.removeToken: called"),AntiCsrfToken.tokenInfo=void 0,[4,setAntiCSRF(void 0)];case 1:return _a.sent(),[2]}}))}))},AntiCsrfToken.setItem=function(associatedAccessTokenUpdate,antiCsrf){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){switch(_a.label){case 0:return void 0===associatedAccessTokenUpdate?(AntiCsrfToken.tokenInfo=void 0,[2]):((0,logger_1.logDebugMessage)("AntiCsrfToken.setItem: called"),[4,setAntiCSRF(antiCsrf)]);case 1:return _a.sent(),AntiCsrfToken.tokenInfo={antiCsrf:antiCsrf,associatedAccessTokenUpdate:associatedAccessTokenUpdate},[2]}}))}))},AntiCsrfToken}();exports.AntiCsrfToken=AntiCsrfToken;var FrontToken=function(){function FrontToken(){}return FrontToken.getTokenInfo=function(){return __awaiter(this,void 0,void 0,(function(){var frontToken,response;return __generator(this,(function(_a){switch(_a.label){case 0:return(0,logger_1.logDebugMessage)("FrontToken.getTokenInfo: called"),[4,getFrontToken()];case 1:return null!==(frontToken=_a.sent())?[3,5]:[4,getLocalSessionState(!1)];case 2:return"EXISTS"!==_a.sent().status?[3,4]:[4,new Promise((function(resolve){FrontToken.waiters.push(resolve)}))];case 3:return _a.sent(),[2,FrontToken.getTokenInfo()];case 4:return[2,void 0];case 5:return response=parseFrontToken(frontToken),(0,logger_1.logDebugMessage)("FrontToken.getTokenInfo: returning ate: "+response.ate),(0,logger_1.logDebugMessage)("FrontToken.getTokenInfo: returning uid: "+response.uid),(0,logger_1.logDebugMessage)("FrontToken.getTokenInfo: returning up: "+response.up),[2,response]}}))}))},FrontToken.removeToken=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){switch(_a.label){case 0:return(0,logger_1.logDebugMessage)("FrontToken.removeToken: called"),[4,setFrontToken(void 0)];case 1:return _a.sent(),[4,setToken("access","")];case 2:return _a.sent(),[4,setToken("refresh","")];case 3:return _a.sent(),FrontToken.waiters.forEach((function(f){return f(void 0)})),FrontToken.waiters=[],[2]}}))}))},FrontToken.setItem=function(frontToken){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){switch(_a.label){case 0:return[4,saveLastAccessTokenUpdate()];case 1:return _a.sent(),"remove"===frontToken?[2,FrontToken.removeToken()]:((0,logger_1.logDebugMessage)("FrontToken.setItem: called"),[4,setFrontToken(frontToken)]);case 2:return _a.sent(),FrontToken.waiters.forEach((function(f){return f(void 0)})),FrontToken.waiters=[],[2]}}))}))},FrontToken.doesTokenExists=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){switch(_a.label){case 0:return[4,getFrontTokenFromCookie()];case 1:return[2,null!==_a.sent()]}}))}))},FrontToken.waiters=[],FrontToken}();exports.FrontToken=FrontToken;var AuthHttpRequest=function(){function AuthHttpRequest(){}var _a;return AuthHttpRequest.init=function(config,recipeImpl){(0,logger_1.logDebugMessage)("init: called"),(0,logger_1.logDebugMessage)("init: Input apiBasePath: "+config.apiBasePath),(0,logger_1.logDebugMessage)("init: Input apiDomain: "+config.apiDomain),(0,logger_1.logDebugMessage)("init: Input autoAddCredentials: "+config.autoAddCredentials),(0,logger_1.logDebugMessage)("init: Input sessionTokenBackendDomain: "+config.sessionTokenBackendDomain),(0,logger_1.logDebugMessage)("init: Input isInIframe: "+config.isInIframe),(0,logger_1.logDebugMessage)("init: Input sessionExpiredStatusCode: "+config.sessionExpiredStatusCode),(0,logger_1.logDebugMessage)("init: Input sessionTokenFrontendDomain: "+config.sessionTokenFrontendDomain),(0,logger_1.logDebugMessage)("init: Input tokenTransferMethod: "+config.tokenTransferMethod);var fetchedWindow=windowHandler_1.default.getReferenceOrThrow().windowHandler.getWindowUnsafe();AuthHttpRequest.env=void 0===fetchedWindow||void 0===fetchedWindow.fetch?__webpack_require__.g:fetchedWindow,AuthHttpRequest.refreshTokenUrl=config.apiDomain+config.apiBasePath+"/session/refresh",AuthHttpRequest.signOutUrl=config.apiDomain+config.apiBasePath+"/signout",AuthHttpRequest.rid="session",AuthHttpRequest.config=config,void 0===AuthHttpRequest.env.__supertokensOriginalFetch&&((0,logger_1.logDebugMessage)("init: __supertokensOriginalFetch is undefined"),AuthHttpRequest.env.__supertokensOriginalFetch=AuthHttpRequest.env.fetch.bind(AuthHttpRequest.env),AuthHttpRequest.env.__supertokensSessionRecipe=recipeImpl,AuthHttpRequest.env.fetch=AuthHttpRequest.env.__supertokensSessionRecipe.addFetchInterceptorsAndReturnModifiedFetch({originalFetch:AuthHttpRequest.env.__supertokensOriginalFetch,userContext:{}}),AuthHttpRequest.env.__supertokensSessionRecipe.addXMLHttpRequestInterceptor({userContext:{}})),AuthHttpRequest.recipeImpl=AuthHttpRequest.env.__supertokensSessionRecipe,AuthHttpRequest.initCalled=!0},_a=AuthHttpRequest,AuthHttpRequest.initCalled=!1,AuthHttpRequest.doRequest=function(httpCall,config,url){return __awaiter(void 0,void 0,void 0,(function(){var doNotDoInterception,finalURL,origHeaders,accessToken,refreshToken,returnObj,preRequestLSS,clonedHeaders,configWithAntiCsrf,antiCsrfToken,transferMethod,response,retry;return __generator(_a,(function(_b){switch(_b.label){case 0:if(!AuthHttpRequest.initCalled)throw Error("init function not called");(0,logger_1.logDebugMessage)("doRequest: start of fetch interception"),doNotDoInterception=!1;try{finalURL=void 0,"string"==typeof url?finalURL=url:"object"==typeof url&&("string"==typeof url.url?finalURL=url.url:"string"==typeof url.href&&(finalURL=url.href)),doNotDoInterception=!AuthHttpRequest.recipeImpl.shouldDoInterceptionBasedOnUrl(finalURL,AuthHttpRequest.config.apiDomain,AuthHttpRequest.config.sessionTokenBackendDomain)}catch(err){if("Please provide a valid domain name"!==err.message)throw err;(0,logger_1.logDebugMessage)("doRequest: Trying shouldDoInterceptionBasedOnUrl with location.origin"),doNotDoInterception=!AuthHttpRequest.recipeImpl.shouldDoInterceptionBasedOnUrl(windowHandler_1.default.getReferenceOrThrow().windowHandler.location.getOrigin(),AuthHttpRequest.config.apiDomain,AuthHttpRequest.config.sessionTokenBackendDomain)}return(0,logger_1.logDebugMessage)("doRequest: Value of doNotDoInterception: "+doNotDoInterception),doNotDoInterception?((0,logger_1.logDebugMessage)("doRequest: Returning without interception"),[4,httpCall(config)]):[3,2];case 1:return[2,_b.sent()];case 2:return(origHeaders=new Headers(void 0!==config&&void 0!==config.headers?config.headers:url.headers)).has("Authorization")?[4,getTokenForHeaderAuth("access")]:[3,5];case 3:return accessToken=_b.sent(),[4,getTokenForHeaderAuth("refresh")];case 4:refreshToken=_b.sent(),void 0!==accessToken&&void 0!==refreshToken&&origHeaders.get("Authorization")==="Bearer ".concat(accessToken)&&((0,logger_1.logDebugMessage)("doRequest: Removing Authorization from user provided headers because it contains our access token"),origHeaders.delete("Authorization")),_b.label=5;case 5:(0,logger_1.logDebugMessage)("doRequest: Interception started"),processState_1.ProcessState.getInstance().addState(processState_1.PROCESS_STATE.CALLING_INTERCEPTION_REQUEST),_b.label=6;case 6:_b.trys.push([6,,20,25]),returnObj=void 0,_b.label=7;case 7:return[4,getLocalSessionState(!0)];case 8:return preRequestLSS=_b.sent(),clonedHeaders=new Headers(origHeaders),configWithAntiCsrf=__assign(__assign({},config),{headers:clonedHeaders}),"EXISTS"!==preRequestLSS.status?[3,10]:[4,AntiCsrfToken.getToken(preRequestLSS.lastAccessTokenUpdate)];case 9:void 0!==(antiCsrfToken=_b.sent())&&((0,logger_1.logDebugMessage)("doRequest: Adding anti-csrf token to request"),clonedHeaders.set("anti-csrf",antiCsrfToken)),_b.label=10;case 10:return AuthHttpRequest.config.autoAddCredentials&&((0,logger_1.logDebugMessage)("doRequest: Adding credentials include"),void 0===configWithAntiCsrf?configWithAntiCsrf={credentials:"include"}:void 0===configWithAntiCsrf.credentials&&(configWithAntiCsrf=__assign(__assign({},configWithAntiCsrf),{credentials:"include"}))),clonedHeaders.has("rid")?(0,logger_1.logDebugMessage)("doRequest: rid header was already there in request"):((0,logger_1.logDebugMessage)("doRequest: Adding rid header: anti-csrf"),clonedHeaders.set("rid","anti-csrf")),transferMethod=AuthHttpRequest.config.tokenTransferMethod,(0,logger_1.logDebugMessage)("doRequest: Adding st-auth-mode header: "+transferMethod),clonedHeaders.set("st-auth-mode",transferMethod),[4,setAuthorizationHeaderIfRequired(clonedHeaders)];case 11:return _b.sent(),(0,logger_1.logDebugMessage)("doRequest: Making user's http call"),[4,httpCall(configWithAntiCsrf)];case 12:return response=_b.sent(),(0,logger_1.logDebugMessage)("doRequest: User's http call ended"),[4,saveTokensFromHeaders(response)];case 13:return _b.sent(),fireSessionUpdateEventsIfNecessary("EXISTS"===preRequestLSS.status,response.status,response.headers.get("front-token")),response.status!==AuthHttpRequest.config.sessionExpiredStatusCode?[3,15]:((0,logger_1.logDebugMessage)("doRequest: Status code is: "+response.status),[4,onUnauthorisedResponse(preRequestLSS)]);case 14:return"RETRY"!==(retry=_b.sent()).result?((0,logger_1.logDebugMessage)("doRequest: Not retrying original request"),returnObj=void 0!==retry.error?retry.error:response,[3,19]):((0,logger_1.logDebugMessage)("doRequest: Retrying original request"),[3,18]);case 15:return response.status!==AuthHttpRequest.config.invalidClaimStatusCode?[3,17]:[4,onInvalidClaimResponse(response)];case 16:_b.sent(),_b.label=17;case 17:return[2,response];case 18:return[3,7];case 19:return[2,returnObj];case 20:return[4,getLocalSessionState(!1)];case 21:return"NOT_EXISTS"!==_b.sent().status?[3,24]:((0,logger_1.logDebugMessage)("doRequest: local session doesn't exist, so removing anti-csrf and sFrontToken"),[4,AntiCsrfToken.removeToken()]);case 22:return _b.sent(),[4,FrontToken.removeToken()];case 23:_b.sent(),_b.label=24;case 24:return[7];case 25:return[2]}}))}))},AuthHttpRequest.attemptRefreshingSession=function(){return __awaiter(void 0,void 0,void 0,(function(){var refresh;return __generator(_a,(function(_b){switch(_b.label){case 0:if(!AuthHttpRequest.initCalled)throw Error("init function not called");return[4,getLocalSessionState(!1)];case 1:return[4,onUnauthorisedResponse(_b.sent())];case 2:if("API_ERROR"===(refresh=_b.sent()).result)throw refresh.error;return[2,"RETRY"===refresh.result]}}))}))},AuthHttpRequest}();exports.default=AuthHttpRequest;var LAST_ACCESS_TOKEN_UPDATE="st-last-access-token-update",REFRESH_TOKEN_NAME="st-refresh-token",ACCESS_TOKEN_NAME="st-access-token",ANTI_CSRF_NAME="sAntiCsrf",FRONT_TOKEN_NAME="sFrontToken";function onUnauthorisedResponse(preRequestLSS){return __awaiter(this,void 0,void 0,(function(){var lock,postLockLSS,headers,antiCsrfToken,transferMethod,preAPIResult,response,isUnauthorised,error_1,postRequestLSS;return __generator(this,(function(_b){switch(_b.label){case 0:return[4,lockFactory_1.default.getReferenceOrThrow().lockFactory()];case 1:lock=_b.sent(),_b.label=2;case 2:return(0,logger_1.logDebugMessage)("onUnauthorisedResponse: trying to acquire lock"),[4,lock.acquireLock("REFRESH_TOKEN_USE",1e3)];case 3:if(!_b.sent())return[3,22];(0,logger_1.logDebugMessage)("onUnauthorisedResponse: lock acquired"),_b.label=4;case 4:return _b.trys.push([4,14,16,22]),[4,getLocalSessionState(!1)];case 5:return"NOT_EXISTS"===(postLockLSS=_b.sent()).status?((0,logger_1.logDebugMessage)("onUnauthorisedResponse: Not refreshing because local session state is NOT_EXISTS"),AuthHttpRequest.config.onHandleEvent({action:"UNAUTHORISED",sessionExpiredOrRevoked:!1,userContext:{}}),[2,{result:"SESSION_EXPIRED"}]):postLockLSS.status!==preRequestLSS.status||"EXISTS"===postLockLSS.status&&"EXISTS"===preRequestLSS.status&&postLockLSS.lastAccessTokenUpdate!==preRequestLSS.lastAccessTokenUpdate?((0,logger_1.logDebugMessage)("onUnauthorisedResponse: Retrying early because pre and post id refresh tokens don't match"),[2,{result:"RETRY"}]):(headers=new Headers,"EXISTS"!==preRequestLSS.status?[3,7]:[4,AntiCsrfToken.getToken(preRequestLSS.lastAccessTokenUpdate)]);case 6:void 0!==(antiCsrfToken=_b.sent())&&((0,logger_1.logDebugMessage)("onUnauthorisedResponse: Adding anti-csrf token to refresh API call"),headers.set("anti-csrf",antiCsrfToken)),_b.label=7;case 7:return(0,logger_1.logDebugMessage)("onUnauthorisedResponse: Adding rid and fdi-versions to refresh call header"),headers.set("rid",AuthHttpRequest.rid),headers.set("fdi-version",version_1.supported_fdi.join(",")),transferMethod=AuthHttpRequest.config.tokenTransferMethod,(0,logger_1.logDebugMessage)("onUnauthorisedResponse: Adding st-auth-mode header: "+transferMethod),headers.set("st-auth-mode",transferMethod),[4,setAuthorizationHeaderIfRequired(headers,!0)];case 8:return _b.sent(),(0,logger_1.logDebugMessage)("onUnauthorisedResponse: Calling refresh pre API hook"),[4,AuthHttpRequest.config.preAPIHook({action:"REFRESH_SESSION",requestInit:{method:"post",credentials:"include",headers:headers},url:AuthHttpRequest.refreshTokenUrl,userContext:{}})];case 9:return preAPIResult=_b.sent(),(0,logger_1.logDebugMessage)("onUnauthorisedResponse: Making refresh call"),[4,AuthHttpRequest.env.__supertokensOriginalFetch(preAPIResult.url,preAPIResult.requestInit)];case 10:return response=_b.sent(),(0,logger_1.logDebugMessage)("onUnauthorisedResponse: Refresh call ended"),[4,saveTokensFromHeaders(response)];case 11:if(_b.sent(),(0,logger_1.logDebugMessage)("onUnauthorisedResponse: Refresh status code is: "+response.status),(isUnauthorised=response.status===AuthHttpRequest.config.sessionExpiredStatusCode)&&null===response.headers.get("front-token")&&FrontToken.setItem("remove"),fireSessionUpdateEventsIfNecessary("EXISTS"===preRequestLSS.status,response.status,isUnauthorised&&null===response.headers.get("front-token")?"remove":response.headers.get("front-token")),response.status>=300)throw response;return[4,AuthHttpRequest.config.postAPIHook({action:"REFRESH_SESSION",fetchResponse:response.clone(),requestInit:preAPIResult.requestInit,url:preAPIResult.url,userContext:{}})];case 12:return _b.sent(),[4,getLocalSessionState(!1)];case 13:return"NOT_EXISTS"===_b.sent().status?((0,logger_1.logDebugMessage)("onUnauthorisedResponse: local session doesn't exist, so returning session expired"),[2,{result:"SESSION_EXPIRED"}]):(AuthHttpRequest.config.onHandleEvent({action:"REFRESH_SESSION",userContext:{}}),(0,logger_1.logDebugMessage)("onUnauthorisedResponse: Sending RETRY signal"),[2,{result:"RETRY"}]);case 14:return error_1=_b.sent(),[4,getLocalSessionState(!1)];case 15:return"NOT_EXISTS"===_b.sent().status?((0,logger_1.logDebugMessage)("onUnauthorisedResponse: local session doesn't exist, so returning session expired"),[2,{result:"SESSION_EXPIRED",error:error_1}]):((0,logger_1.logDebugMessage)("onUnauthorisedResponse: sending API_ERROR"),[2,{result:"API_ERROR",error:error_1}]);case 16:return[4,lock.releaseLock("REFRESH_TOKEN_USE")];case 17:return _b.sent(),(0,logger_1.logDebugMessage)("onUnauthorisedResponse: Released lock"),[4,getLocalSessionState(!1)];case 18:return"NOT_EXISTS"!==_b.sent().status?[3,21]:((0,logger_1.logDebugMessage)("onUnauthorisedResponse: local session doesn't exist, so removing anti-csrf and sFrontToken"),[4,AntiCsrfToken.removeToken()]);case 19:return _b.sent(),[4,FrontToken.removeToken()];case 20:_b.sent(),_b.label=21;case 21:return[7];case 22:return[4,getLocalSessionState(!1)];case 23:return"NOT_EXISTS"===(postRequestLSS=_b.sent()).status?((0,logger_1.logDebugMessage)("onUnauthorisedResponse: lock acquired failed and local session doesn't exist, so sending SESSION_EXPIRED"),[2,{result:"SESSION_EXPIRED"}]):postRequestLSS.status!==preRequestLSS.status||"EXISTS"===postRequestLSS.status&&"EXISTS"===preRequestLSS.status&&postRequestLSS.lastAccessTokenUpdate!==preRequestLSS.lastAccessTokenUpdate?((0,logger_1.logDebugMessage)("onUnauthorisedResponse: lock acquired failed and retrying early because pre and post id refresh tokens don't match"),[2,{result:"RETRY"}]):[3,2];case 24:return[2]}}))}))}function onTokenUpdate(){(0,logger_1.logDebugMessage)("onTokenUpdate: firing ACCESS_TOKEN_PAYLOAD_UPDATED event"),AuthHttpRequest.config.onHandleEvent({action:"ACCESS_TOKEN_PAYLOAD_UPDATED",userContext:{}})}function onInvalidClaimResponse(response){return __awaiter(this,void 0,void 0,(function(){var claimValidationErrors;return __generator(this,(function(_c){switch(_c.label){case 0:return _c.trys.push([0,2,,3]),[4,AuthHttpRequest.recipeImpl.getInvalidClaimsFromResponse({response:response,userContext:{}})];case 1:return(claimValidationErrors=_c.sent())&&AuthHttpRequest.config.onHandleEvent({action:"API_INVALID_CLAIM",claimValidationErrors:claimValidationErrors,userContext:{}}),[3,3];case 2:return _c.sent(),[3,3];case 3:return[2]}}))}))}function getLocalSessionState(tryRefresh){return __awaiter(this,void 0,void 0,(function(){var lastAccessTokenUpdate,response,res;return __generator(this,(function(_b){switch(_b.label){case 0:return(0,logger_1.logDebugMessage)("getLocalSessionState: called"),[4,getFromCookies(LAST_ACCESS_TOKEN_UPDATE)];case 1:return lastAccessTokenUpdate=_b.sent(),[4,FrontToken.doesTokenExists()];case 2:return _b.sent()&&void 0!==lastAccessTokenUpdate?((0,logger_1.logDebugMessage)("getLocalSessionState: returning EXISTS since both frontToken and lastAccessTokenUpdate exists"),[2,{status:"EXISTS",lastAccessTokenUpdate:lastAccessTokenUpdate}]):[3,3];case 3:return lastAccessTokenUpdate?((0,logger_1.logDebugMessage)("getLocalSessionState: returning NOT_EXISTS since frontToken was cleared but lastAccessTokenUpdate exists"),[2,{status:"NOT_EXISTS"}]):[3,4];case 4:return response={status:"MAY_EXIST"},tryRefresh?((0,logger_1.logDebugMessage)("getLocalSessionState: trying to refresh"),[4,onUnauthorisedResponse(response)]):[3,7];case 5:return"RETRY"!==(res=_b.sent()).result?((0,logger_1.logDebugMessage)("getLocalSessionState: return NOT_EXISTS in case error from backend"+res.result),[2,{status:"NOT_EXISTS"}]):((0,logger_1.logDebugMessage)("getLocalSessionState: Retrying post refresh"),[4,getLocalSessionState(tryRefresh)]);case 6:return[2,_b.sent()];case 7:return(0,logger_1.logDebugMessage)("getLocalSessionState: returning: "+response.status),[2,response]}}))}))}function getStorageNameForToken(tokenType){switch(tokenType){case"access":return ACCESS_TOKEN_NAME;case"refresh":return REFRESH_TOKEN_NAME}}function setToken(tokenType,value){var name=getStorageNameForToken(tokenType);return""!==value?((0,logger_1.logDebugMessage)("setToken: saved ".concat(tokenType," token into cookies")),storeInCookies(name,value,Date.now()+31536e5)):((0,logger_1.logDebugMessage)("setToken: cleared ".concat(tokenType," token from cookies")),storeInCookies(name,value,0))}function storeInCookies(name,value,expiry){var expires="Fri, 31 Dec 9999 23:59:59 GMT";expiry!==Number.MAX_SAFE_INTEGER&&(expires=new Date(expiry).toUTCString());var domain=AuthHttpRequest.config.sessionTokenFrontendDomain;return"localhost"===domain||domain===windowHandler_1.default.getReferenceOrThrow().windowHandler.location.getHostName()?cookieHandler_1.default.getReferenceOrThrow().cookieHandler.setCookie("".concat(name,"=").concat(value,";expires=").concat(expires,";path=/;samesite=").concat(AuthHttpRequest.config.isInIframe?"none;secure":"lax")):cookieHandler_1.default.getReferenceOrThrow().cookieHandler.setCookie("".concat(name,"=").concat(value,";expires=").concat(expires,";domain=").concat(domain,";path=/;samesite=").concat(AuthHttpRequest.config.isInIframe?"none;secure":"lax"))}function getTokenForHeaderAuth(tokenType){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_b){return[2,getFromCookies(getStorageNameForToken(tokenType))]}))}))}function getFromCookies(name){return __awaiter(this,void 0,void 0,(function(){var value,_b,parts,last;return __generator(this,(function(_c){switch(_c.label){case 0:return _b="; ",[4,cookieHandler_1.default.getReferenceOrThrow().cookieHandler.getCookie()];case 1:return value=_b+_c.sent(),(parts=value.split("; "+name+"=")).length>=2&&void 0!==(last=parts.pop())?[2,last.split(";").shift()]:[2,void 0]}}))}))}function setAuthorizationHeaderIfRequired(clonedHeaders,addRefreshToken){return void 0===addRefreshToken&&(addRefreshToken=!1),__awaiter(this,void 0,void 0,(function(){var accessToken,refreshToken;return __generator(this,(function(_b){switch(_b.label){case 0:return(0,logger_1.logDebugMessage)("setTokenHeaders: adding existing tokens as header"),[4,getTokenForHeaderAuth("access")];case 1:return accessToken=_b.sent(),[4,getTokenForHeaderAuth("refresh")];case 2:return refreshToken=_b.sent(),!addRefreshToken&&void 0===accessToken||void 0===refreshToken?(0,logger_1.logDebugMessage)("setAuthorizationHeaderIfRequired: token for header based auth not found"):clonedHeaders.has("Authorization")?(0,logger_1.logDebugMessage)("setAuthorizationHeaderIfRequired: Authorization header defined by the user, not adding"):((0,logger_1.logDebugMessage)("setAuthorizationHeaderIfRequired: added authorization header"),clonedHeaders.set("Authorization","Bearer ".concat(addRefreshToken?refreshToken:accessToken))),[2]}}))}))}function saveTokensFromHeaders(response){return __awaiter(this,void 0,void 0,(function(){var refreshToken,accessToken,frontToken,antiCsrfToken,tok;return __generator(this,(function(_b){switch(_b.label){case 0:return(0,logger_1.logDebugMessage)("saveTokensFromHeaders: Saving updated tokens from the response headers"),null===(refreshToken=response.headers.get("st-refresh-token"))?[3,2]:((0,logger_1.logDebugMessage)("saveTokensFromHeaders: saving new refresh token"),[4,setToken("refresh",refreshToken)]);case 1:_b.sent(),_b.label=2;case 2:return null===(accessToken=response.headers.get("st-access-token"))?[3,4]:((0,logger_1.logDebugMessage)("saveTokensFromHeaders: saving new access token"),[4,setToken("access",accessToken)]);case 3:_b.sent(),_b.label=4;case 4:return null===(frontToken=response.headers.get("front-token"))?[3,6]:((0,logger_1.logDebugMessage)("saveTokensFromHeaders: Setting sFrontToken: "+frontToken),[4,FrontToken.setItem(frontToken)]);case 5:_b.sent(),_b.label=6;case 6:return null===(antiCsrfToken=response.headers.get("anti-csrf"))?[3,9]:[4,getLocalSessionState(!0)];case 7:return"EXISTS"!==(tok=_b.sent()).status?[3,9]:((0,logger_1.logDebugMessage)("saveTokensFromHeaders: Setting anti-csrf token"),[4,AntiCsrfToken.setItem(tok.lastAccessTokenUpdate,antiCsrfToken)]);case 8:_b.sent(),_b.label=9;case 9:return[2]}}))}))}function saveLastAccessTokenUpdate(){return __awaiter(this,void 0,void 0,(function(){var now;return __generator(this,(function(_b){switch(_b.label){case 0:return(0,logger_1.logDebugMessage)("saveLastAccessTokenUpdate: called"),now=Date.now().toString(),(0,logger_1.logDebugMessage)("saveLastAccessTokenUpdate: setting "+now),[4,storeInCookies(LAST_ACCESS_TOKEN_UPDATE,now,Number.MAX_SAFE_INTEGER)];case 1:return _b.sent(),[4,storeInCookies("sIRTFrontend","",0)];case 2:return _b.sent(),[2]}}))}))}function getAntiCSRFToken(){return __awaiter(this,void 0,void 0,(function(){function getAntiCSRFromCookie(){return __awaiter(this,void 0,void 0,(function(){var value,_b,parts,last,temp;return __generator(this,(function(_c){switch(_c.label){case 0:return _b="; ",[4,cookieHandler_1.default.getReferenceOrThrow().cookieHandler.getCookie()];case 1:return value=_b+_c.sent(),(parts=value.split("; "+ANTI_CSRF_NAME+"=")).length>=2&&void 0!==(last=parts.pop())?void 0===(temp=last.split(";").shift())?[2,null]:[2,temp]:[2,null]}}))}))}var fromCookie;return __generator(this,(function(_b){switch(_b.label){case 0:return(0,logger_1.logDebugMessage)("getAntiCSRFToken: called"),[4,getLocalSessionState(!0)];case 1:return"EXISTS"!==_b.sent().status?((0,logger_1.logDebugMessage)("getAntiCSRFToken: Returning because local session state != EXISTS"),[2,null]):[4,getAntiCSRFromCookie()];case 2:return fromCookie=_b.sent(),(0,logger_1.logDebugMessage)("getAntiCSRFToken: returning: "+fromCookie),[2,fromCookie]}}))}))}function setAntiCSRF(antiCSRFToken){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_b){switch(_b.label){case 0:return(0,logger_1.logDebugMessage)("setAntiCSRF: called: "+antiCSRFToken),void 0===antiCSRFToken?[3,2]:[4,storeInCookies(ANTI_CSRF_NAME,antiCSRFToken,Number.MAX_SAFE_INTEGER)];case 1:return _b.sent(),[3,4];case 2:return[4,storeInCookies(ANTI_CSRF_NAME,"",0)];case 3:_b.sent(),_b.label=4;case 4:return[2]}}))}))}function getFrontTokenFromCookie(){return __awaiter(this,void 0,void 0,(function(){var val;return __generator(this,(function(_b){switch(_b.label){case 0:return(0,logger_1.logDebugMessage)("getFrontTokenFromCookie: called"),[4,getFromCookies(FRONT_TOKEN_NAME)];case 1:return[2,void 0===(val=_b.sent())?null:val]}}))}))}function parseFrontToken(frontToken){return JSON.parse(decodeURIComponent(escape(atob(frontToken))))}function getFrontToken(){return __awaiter(this,void 0,void 0,(function(){var fromCookie;return __generator(this,(function(_b){switch(_b.label){case 0:return(0,logger_1.logDebugMessage)("getFrontToken: called"),[4,getLocalSessionState(!0)];case 1:return"EXISTS"!==_b.sent().status?((0,logger_1.logDebugMessage)("getFrontToken: Returning because sIRTFrontend != EXISTS"),[2,null]):[4,getFrontTokenFromCookie()];case 2:return fromCookie=_b.sent(),(0,logger_1.logDebugMessage)("getFrontToken: returning: "+fromCookie),[2,fromCookie]}}))}))}function setFrontToken(frontToken){return __awaiter(this,void 0,void 0,(function(){var oldToken,oldPayload,newPayload;return __generator(this,(function(_b){switch(_b.label){case 0:return(0,logger_1.logDebugMessage)("setFrontToken: called"),[4,getFrontTokenFromCookie()];case 1:return null!==(oldToken=_b.sent())&&void 0!==frontToken&&(oldPayload=parseFrontToken(oldToken).up,newPayload=parseFrontToken(frontToken).up,JSON.stringify(oldPayload)!==JSON.stringify(newPayload)&&onTokenUpdate()),void 0!==frontToken?[3,3]:[4,storeInCookies(FRONT_TOKEN_NAME,"",0)];case 2:return _b.sent(),[3,5];case 3:return[4,storeInCookies(FRONT_TOKEN_NAME,frontToken,Number.MAX_SAFE_INTEGER)];case 4:_b.sent(),_b.label=5;case 5:return[2]}}))}))}function fireSessionUpdateEventsIfNecessary(wasLoggedIn,status,frontTokenHeaderFromResponse){if(null!=frontTokenHeaderFromResponse){var frontTokenExistsAfter="remove"!==frontTokenHeaderFromResponse;(0,logger_1.logDebugMessage)("fireSessionUpdateEventsIfNecessary wasLoggedIn: ".concat(wasLoggedIn," frontTokenExistsAfter: ").concat(frontTokenExistsAfter," status: ").concat(status)),wasLoggedIn?frontTokenExistsAfter||(status===AuthHttpRequest.config.sessionExpiredStatusCode?((0,logger_1.logDebugMessage)("onUnauthorisedResponse: firing UNAUTHORISED event"),AuthHttpRequest.config.onHandleEvent({action:"UNAUTHORISED",sessionExpiredOrRevoked:!0,userContext:{}})):((0,logger_1.logDebugMessage)("onUnauthorisedResponse: firing SIGN_OUT event"),AuthHttpRequest.config.onHandleEvent({action:"SIGN_OUT",userContext:{}}))):frontTokenExistsAfter&&((0,logger_1.logDebugMessage)("onUnauthorisedResponse: firing SESSION_CREATED event"),AuthHttpRequest.config.onHandleEvent({action:"SESSION_CREATED",userContext:{}}))}else(0,logger_1.logDebugMessage)("fireSessionUpdateEventsIfNecessary returning early because the front token was not updated")}exports.onUnauthorisedResponse=onUnauthorisedResponse,exports.onTokenUpdate=onTokenUpdate,exports.onInvalidClaimResponse=onInvalidClaimResponse,exports.getLocalSessionState=getLocalSessionState,exports.getStorageNameForToken=getStorageNameForToken,exports.setToken=setToken,exports.getTokenForHeaderAuth=getTokenForHeaderAuth,exports.saveLastAccessTokenUpdate=saveLastAccessTokenUpdate,exports.setAntiCSRF=setAntiCSRF,exports.getFrontToken=getFrontToken,exports.setFrontToken=setFrontToken,exports.fireSessionUpdateEventsIfNecessary=fireSessionUpdateEventsIfNecessary},"../supertokens-web-js/node_modules/supertokens-website/lib/build/index.js":function(__unused_webpack_module,exports,__webpack_require__){var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.BooleanClaim=exports.PrimitiveArrayClaim=exports.PrimitiveClaim=exports.getInvalidClaimsFromResponse=exports.getClaimValue=exports.validateClaims=exports.signOut=exports.addAxiosInterceptors=exports.doesSessionExist=exports.attemptRefreshingSession=exports.getAccessToken=exports.getAccessTokenPayloadSecurely=exports.getUserId=exports.init=void 0;var fetch_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/fetch.js"),recipeImplementation_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/recipeImplementation.js"),supertokens_js_override_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-js-override/lib/build/index.js"),utils_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/utils/index.js"),cookieHandler_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/utils/cookieHandler/index.js"),windowHandler_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/utils/windowHandler/index.js"),lockFactory_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/utils/lockFactory/index.js"),sessionClaimValidatorStore_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/utils/sessionClaimValidatorStore.js"),AuthHttpRequest=function(){function AuthHttpRequest(){}var _a;return AuthHttpRequest.init=function(options){cookieHandler_1.default.init(options.cookieHandler),windowHandler_1.default.init(options.windowHandler),lockFactory_1.default.init(options.lockFactory,windowHandler_1.default.getReferenceOrThrow().windowHandler.localStorage);var config=(0,utils_1.validateAndNormaliseInputOrThrowError)(options),recipeImpl=new supertokens_js_override_1.default((0,recipeImplementation_1.default)({onHandleEvent:config.onHandleEvent,preAPIHook:config.preAPIHook,postAPIHook:config.postAPIHook,sessionExpiredStatusCode:config.sessionExpiredStatusCode})).override(config.override.functions).build();fetch_1.default.init(config,recipeImpl),AuthHttpRequest.axiosInterceptorQueue.forEach((function(f){f()})),AuthHttpRequest.axiosInterceptorQueue=[]},AuthHttpRequest.getUserId=function(input){return fetch_1.default.recipeImpl.getUserId({userContext:(0,utils_1.getNormalisedUserContext)(void 0===input?void 0:input.userContext)})},AuthHttpRequest.getAccessTokenPayloadSecurely=function(input){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_b){return[2,fetch_1.default.recipeImpl.getAccessTokenPayloadSecurely({userContext:(0,utils_1.getNormalisedUserContext)(void 0===input?void 0:input.userContext)})]}))}))},_a=AuthHttpRequest,AuthHttpRequest.axiosInterceptorQueue=[],AuthHttpRequest.attemptRefreshingSession=function(){return __awaiter(void 0,void 0,void 0,(function(){return __generator(_a,(function(_b){return[2,fetch_1.default.attemptRefreshingSession()]}))}))},AuthHttpRequest.doesSessionExist=function(input){return fetch_1.default.recipeImpl.doesSessionExist({userContext:(0,utils_1.getNormalisedUserContext)(void 0===input?void 0:input.userContext)})},AuthHttpRequest.addAxiosInterceptors=function(axiosInstance,userContext){fetch_1.default.initCalled?fetch_1.default.recipeImpl.addAxiosInterceptors({axiosInstance:axiosInstance,userContext:(0,utils_1.getNormalisedUserContext)(userContext)}):AuthHttpRequest.axiosInterceptorQueue.push((function(){fetch_1.default.recipeImpl.addAxiosInterceptors({axiosInstance:axiosInstance,userContext:(0,utils_1.getNormalisedUserContext)(userContext)})}))},AuthHttpRequest.signOut=function(input){return fetch_1.default.recipeImpl.signOut({userContext:(0,utils_1.getNormalisedUserContext)(void 0===input?void 0:input.userContext)})},AuthHttpRequest.getInvalidClaimsFromResponse=function(input){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_b){return[2,fetch_1.default.recipeImpl.getInvalidClaimsFromResponse({response:input.response,userContext:(0,utils_1.getNormalisedUserContext)(input.userContext)})]}))}))},AuthHttpRequest.getClaimValue=function(input){return __awaiter(this,void 0,void 0,(function(){var userContext,accessTokenPayload;return __generator(this,(function(_b){switch(_b.label){case 0:return userContext=(0,utils_1.getNormalisedUserContext)(void 0===input?void 0:input.userContext),[4,AuthHttpRequest.getAccessTokenPayloadSecurely({userContext:userContext})];case 1:return accessTokenPayload=_b.sent(),[2,input.claim.getValueFromPayload(accessTokenPayload,userContext)]}}))}))},AuthHttpRequest.validateClaims=function(overrideGlobalClaimValidators,userContext){var normalisedUserContext=(0,utils_1.getNormalisedUserContext)(userContext),claimValidatorsAddedByOtherRecipes=sessionClaimValidatorStore_1.SessionClaimValidatorStore.getClaimValidatorsAddedByOtherRecipes(),globalClaimValidators=fetch_1.default.recipeImpl.getGlobalClaimValidators({claimValidatorsAddedByOtherRecipes:claimValidatorsAddedByOtherRecipes,userContext:normalisedUserContext}),claimValidators=void 0!==overrideGlobalClaimValidators?overrideGlobalClaimValidators(globalClaimValidators,normalisedUserContext):globalClaimValidators;return 0===claimValidators.length?[]:fetch_1.default.recipeImpl.validateClaims({claimValidators:claimValidators,userContext:(0,utils_1.getNormalisedUserContext)(userContext)})},AuthHttpRequest.getAccessToken=function(input){return __awaiter(void 0,void 0,void 0,(function(){return __generator(_a,(function(_b){switch(_b.label){case 0:return[4,fetch_1.default.recipeImpl.doesSessionExist({userContext:(0,utils_1.getNormalisedUserContext)(void 0===input?void 0:input.userContext)})];case 1:return _b.sent()?[2,(0,fetch_1.getTokenForHeaderAuth)("access")]:[2,void 0]}}))}))},AuthHttpRequest}();exports.default=AuthHttpRequest,exports.init=AuthHttpRequest.init,exports.getUserId=AuthHttpRequest.getUserId,exports.getAccessTokenPayloadSecurely=AuthHttpRequest.getAccessTokenPayloadSecurely,exports.getAccessToken=AuthHttpRequest.getAccessToken,exports.attemptRefreshingSession=AuthHttpRequest.attemptRefreshingSession,exports.doesSessionExist=AuthHttpRequest.doesSessionExist,exports.addAxiosInterceptors=AuthHttpRequest.addAxiosInterceptors,exports.signOut=AuthHttpRequest.signOut,exports.validateClaims=AuthHttpRequest.validateClaims,exports.getClaimValue=AuthHttpRequest.getClaimValue,exports.getInvalidClaimsFromResponse=AuthHttpRequest.getInvalidClaimsFromResponse;var primitiveClaim_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/claims/primitiveClaim.js");Object.defineProperty(exports,"PrimitiveClaim",{enumerable:!0,get:function(){return primitiveClaim_1.PrimitiveClaim}});var primitiveArrayClaim_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/claims/primitiveArrayClaim.js");Object.defineProperty(exports,"PrimitiveArrayClaim",{enumerable:!0,get:function(){return primitiveArrayClaim_1.PrimitiveArrayClaim}});var booleanClaim_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/claims/booleanClaim.js");Object.defineProperty(exports,"BooleanClaim",{enumerable:!0,get:function(){return booleanClaim_1.BooleanClaim}})},"../supertokens-web-js/node_modules/supertokens-website/lib/build/logger.js":function(__unused_webpack_module,exports,__webpack_require__){Object.defineProperty(exports,"__esModule",{value:!0}),exports.logDebugMessage=exports.disableLogging=exports.enableLogging=void 0;var version_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/version.js"),__supertokensWebsiteLogging=!1;exports.enableLogging=function enableLogging(){__supertokensWebsiteLogging=!0},exports.disableLogging=function disableLogging(){__supertokensWebsiteLogging=!1},exports.logDebugMessage=function logDebugMessage(message){__supertokensWebsiteLogging&&console.log("".concat("com.supertokens",' {t: "').concat((new Date).toISOString(),'", message: "').concat(message,'", supertokens-website-ver: "').concat(version_1.package_version,'"}'))}},"../supertokens-web-js/node_modules/supertokens-website/lib/build/normalisedURLDomain.js":function(__unused_webpack_module,exports){function isAnIpAddress(ipaddress){return/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(ipaddress)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.isAnIpAddress=void 0,exports.isAnIpAddress=isAnIpAddress;var NormalisedURLDomain=function NormalisedURLDomain(url){var _this=this;this.getAsStringDangerous=function(){return _this.value},this.value=normaliseURLDomainOrThrowError(url)};function normaliseURLDomainOrThrowError(input,ignoreProtocol){void 0===ignoreProtocol&&(ignoreProtocol=!1),input=input.trim();try{if(!input.startsWith("http://")&&!input.startsWith("https://"))throw new Error("converting to proper URL");var urlObj=new URL(input);return input=ignoreProtocol?urlObj.hostname.startsWith("localhost")||isAnIpAddress(urlObj.hostname)?"http://"+urlObj.host:"https://"+urlObj.host:urlObj.protocol+"//"+urlObj.host}catch(err){}if(input.startsWith("/"))throw new Error("Please provide a valid domain name");if(0===input.indexOf(".")&&(input=input.substr(1)),(-1!==input.indexOf(".")||input.startsWith("localhost"))&&!input.startsWith("http://")&&!input.startsWith("https://")){input="https://"+input;try{return new URL(input),normaliseURLDomainOrThrowError(input,!0)}catch(err){}}throw new Error("Please provide a valid domain name")}exports.default=NormalisedURLDomain},"../supertokens-web-js/node_modules/supertokens-website/lib/build/normalisedURLPath.js":function(__unused_webpack_module,exports){Object.defineProperty(exports,"__esModule",{value:!0});var NormalisedURLPath=function NormalisedURLPath(url){var _this=this;this.startsWith=function(other){return _this.value.startsWith(other.value)},this.appendPath=function(other){return new NormalisedURLPath(_this.value+other.value)},this.getAsStringDangerous=function(){return _this.value},this.value=normaliseURLPathOrThrowError(url)};function normaliseURLPathOrThrowError(input){input=input.trim();try{if(!input.startsWith("http://")&&!input.startsWith("https://"))throw new Error("converting to proper URL");return"/"===(input=new URL(input).pathname).charAt(input.length-1)?input.substr(0,input.length-1):input}catch(err){}if((function domainGiven(input){if(-1===input.indexOf(".")||input.startsWith("/"))return!1;try{return-1!==new URL(input).hostname.indexOf(".")}catch(e){}try{return-1!==new URL("http://"+input).hostname.indexOf(".")}catch(e){}return!1}(input)||input.startsWith("localhost"))&&!input.startsWith("http://")&&!input.startsWith("https://"))return normaliseURLPathOrThrowError(input="http://"+input);"/"!==input.charAt(0)&&(input="/"+input);try{return new URL("http://example.com"+input),normaliseURLPathOrThrowError("http://example.com"+input)}catch(err){throw new Error("Please provide a valid URL path")}}exports.default=NormalisedURLPath},"../supertokens-web-js/node_modules/supertokens-website/lib/build/processState.js":function(__unused_webpack_module,exports,__webpack_require__){var process=__webpack_require__("./node_modules/process/browser.js"),__awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.ProcessState=exports.PROCESS_STATE=void 0,function(PROCESS_STATE){PROCESS_STATE[PROCESS_STATE.CALLING_INTERCEPTION_REQUEST=0]="CALLING_INTERCEPTION_REQUEST",PROCESS_STATE[PROCESS_STATE.CALLING_INTERCEPTION_RESPONSE=1]="CALLING_INTERCEPTION_RESPONSE"}(exports.PROCESS_STATE||(exports.PROCESS_STATE={}));var ProcessState=function(){function ProcessState(){var _this=this;this.history=[],this.addState=function(state){try{void 0!==process&&void 0!==process.env&&"testing"===process.env.TEST_MODE&&_this.history.push(state)}catch(ignored){}},this.getEventByLastEventByName=function(state){for(var i=_this.history.length-1;i>=0;i--)if(_this.history[i]==state)return _this.history[i]},this.reset=function(){_this.history=[]},this.waitForEvent=function(state,timeInMS){return void 0===timeInMS&&(timeInMS=7e3),__awaiter(_this,void 0,void 0,(function(){var startTime,_this=this;return __generator(this,(function(_a){return startTime=Date.now(),[2,new Promise((function(resolve){var actualThis=_this;!function tryAndGet(){var result=actualThis.getEventByLastEventByName(state);void 0===result?Date.now()-startTime>timeInMS?resolve(void 0):setTimeout(tryAndGet,1e3):resolve(result)}()}))]}))}))}}return ProcessState.getInstance=function(){return null==ProcessState.instance&&(ProcessState.instance=new ProcessState),ProcessState.instance},ProcessState}();exports.ProcessState=ProcessState},"../supertokens-web-js/node_modules/supertokens-website/lib/build/recipeImplementation.js":function(__unused_webpack_module,exports,__webpack_require__){var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t},__assign.apply(this,arguments)},__awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}};Object.defineProperty(exports,"__esModule",{value:!0});var fetch_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/fetch.js"),axios_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/axios.js"),version_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/version.js"),logger_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/logger.js"),error_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/error.js"),xmlhttprequest_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/xmlhttprequest.js"),utils_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/utils/index.js");exports.default=function RecipeImplementation(recipeImplInput){return{addXMLHttpRequestInterceptor:function(_){(0,logger_1.logDebugMessage)("addXMLHttpRequestInterceptorAndReturnModified: called"),(0,xmlhttprequest_1.addInterceptorsToXMLHttpRequest)()},addFetchInterceptorsAndReturnModifiedFetch:function(input){return(0,logger_1.logDebugMessage)("addFetchInterceptorsAndReturnModifiedFetch: called"),function(url,config){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){switch(_a.label){case 0:return[4,fetch_1.default.doRequest((function(config){return input.originalFetch("object"==typeof url&&"clone"in url?url.clone():url,__assign({},config))}),config,url)];case 1:return[2,_a.sent()]}}))}))}},addAxiosInterceptors:function(input){if((0,logger_1.logDebugMessage)("addAxiosInterceptors: called"),XMLHttpRequest.__interceptedBySuperTokens)return console.warn("Not adding axios interceptor since XMLHttpRequest is already added. This is just a warning."),console.warn("Our axios and XMLHttpRequest interceptors cannot be used at the same time."),console.warn("Since XMLHttpRequest is added automatically and supports axios by default, you can just remove addAxiosInterceptors from your code."),console.warn("If you want to continue using our axios interceptor, you can override addXMLHttpRequestInterceptor with an empty function."),void(0,logger_1.logDebugMessage)("addAxiosInterceptors: not adding, because XHR interceptors are already in place");for(var requestInterceptors=input.axiosInstance.interceptors.request,i=0;i<requestInterceptors.handlers.length;i++)if(requestInterceptors.handlers[i].fulfilled===axios_1.interceptorFunctionRequestFulfilled)return void(0,logger_1.logDebugMessage)("addAxiosInterceptors: not adding because already added on this instance");input.axiosInstance.interceptors.request.use(axios_1.interceptorFunctionRequestFulfilled,(function(error){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){throw error}))}))})),input.axiosInstance.interceptors.response.use((0,axios_1.responseInterceptor)(input.axiosInstance),(0,axios_1.responseErrorInterceptor)(input.axiosInstance))},getUserId:function(_){return __awaiter(this,void 0,void 0,(function(){var tokenInfo;return __generator(this,(function(_a){switch(_a.label){case 0:return(0,logger_1.logDebugMessage)("getUserId: called"),[4,fetch_1.FrontToken.getTokenInfo()];case 1:if(void 0===(tokenInfo=_a.sent()))throw new Error("No session exists");return(0,logger_1.logDebugMessage)("getUserId: returning: "+tokenInfo.uid),[2,tokenInfo.uid]}}))}))},getAccessTokenPayloadSecurely:function(input){return __awaiter(this,void 0,void 0,(function(){var tokenInfo;return __generator(this,(function(_a){switch(_a.label){case 0:return(0,logger_1.logDebugMessage)("getAccessTokenPayloadSecurely: called"),[4,fetch_1.FrontToken.getTokenInfo()];case 1:if(void 0===(tokenInfo=_a.sent()))throw new Error("No session exists");return tokenInfo.ate<Date.now()?((0,logger_1.logDebugMessage)("getAccessTokenPayloadSecurely: access token expired. Refreshing session"),[4,fetch_1.default.attemptRefreshingSession()]):[3,5];case 2:return _a.sent()?[4,this.getAccessTokenPayloadSecurely({userContext:input.userContext})]:[3,4];case 3:return[2,_a.sent()];case 4:throw new Error("Could not refresh session");case 5:return(0,logger_1.logDebugMessage)("getAccessTokenPayloadSecurely: returning: "+JSON.stringify(tokenInfo.up)),[2,tokenInfo.up]}}))}))},doesSessionExist:function(_){return __awaiter(this,void 0,void 0,(function(){var tokenInfo,preRequestLSS;return __generator(this,(function(_a){switch(_a.label){case 0:return(0,logger_1.logDebugMessage)("doesSessionExist: called"),[4,fetch_1.FrontToken.getTokenInfo()];case 1:return void 0===(tokenInfo=_a.sent())?((0,logger_1.logDebugMessage)("doesSessionExist: access token does not exist locally"),[2,!1]):tokenInfo.ate<Date.now()?((0,logger_1.logDebugMessage)("doesSessionExist: access token expired. Refreshing session"),[4,(0,fetch_1.getLocalSessionState)(!1)]):[3,4];case 2:return preRequestLSS=_a.sent(),[4,(0,fetch_1.onUnauthorisedResponse)(preRequestLSS)];case 3:return[2,"RETRY"===_a.sent().result];case 4:return[2,!0]}}))}))},signOut:function(input){return __awaiter(this,void 0,void 0,(function(){var preAPIResult,resp,responseJson,message;return __generator(this,(function(_a){switch(_a.label){case 0:return(0,logger_1.logDebugMessage)("signOut: called"),[4,this.doesSessionExist(input)];case 1:return _a.sent()?((0,logger_1.logDebugMessage)("signOut: Calling refresh pre API hook"),[4,recipeImplInput.preAPIHook({action:"SIGN_OUT",requestInit:{method:"post",headers:{"fdi-version":version_1.supported_fdi.join(","),rid:fetch_1.default.rid}},url:fetch_1.default.signOutUrl,userContext:input.userContext})]):((0,logger_1.logDebugMessage)("signOut: exiting early because session does not exist"),(0,logger_1.logDebugMessage)("signOut: firing SIGN_OUT event"),recipeImplInput.onHandleEvent({action:"SIGN_OUT",userContext:input.userContext}),[2]);case 2:return preAPIResult=_a.sent(),(0,logger_1.logDebugMessage)("signOut: Calling API"),[4,fetch(preAPIResult.url,preAPIResult.requestInit)];case 3:if(resp=_a.sent(),(0,logger_1.logDebugMessage)("signOut: API ended"),(0,logger_1.logDebugMessage)("signOut: API responded with status code: "+resp.status),resp.status===recipeImplInput.sessionExpiredStatusCode)return[2];if(resp.status>=300)throw resp;return[4,recipeImplInput.postAPIHook({action:"SIGN_OUT",requestInit:preAPIResult.requestInit,url:preAPIResult.url,fetchResponse:resp.clone(),userContext:input.userContext})];case 4:return _a.sent(),[4,resp.clone().json()];case 5:if("GENERAL_ERROR"===(responseJson=_a.sent()).status)throw(0,logger_1.logDebugMessage)("doRequest: Throwing general error"),message=void 0===responseJson.message?"No Error Message Provided":responseJson.message,new error_1.STGeneralError(message);return[2]}}))}))},getInvalidClaimsFromResponse:function(input){return __awaiter(this,void 0,void 0,(function(){var body;return __generator(this,(function(_a){switch(_a.label){case 0:return"body"in input.response?[4,input.response.clone().json()]:[3,2];case 1:return body=_a.sent(),[3,3];case 2:body="string"==typeof input.response.data?JSON.parse(input.response.data):input.response.data,_a.label=3;case 3:return[2,body.claimValidationErrors]}}))}))},getGlobalClaimValidators:function(input){return input.claimValidatorsAddedByOtherRecipes},validateClaims:function(input){return __awaiter(this,void 0,void 0,(function(){var accessTokenPayload,_i,_a,err_1,errors,_b,_c,validator,validationRes;return __generator(this,(function(_d){switch(_d.label){case 0:return[4,this.getAccessTokenPayloadSecurely({userContext:input.userContext})];case 1:accessTokenPayload=_d.sent(),_i=0,_a=input.claimValidators,_d.label=2;case 2:return _i<_a.length?[4,(validator=_a[_i]).shouldRefresh(accessTokenPayload,input.userContext)]:[3,10];case 3:if(!_d.sent())return[3,9];_d.label=4;case 4:return _d.trys.push([4,6,,7]),[4,validator.refresh(input.userContext)];case 5:return _d.sent(),[3,7];case 6:return err_1=_d.sent(),console.error("Encountered an error while refreshing validator ".concat(validator.id),err_1),[3,7];case 7:return[4,this.getAccessTokenPayloadSecurely({userContext:input.userContext})];case 8:accessTokenPayload=_d.sent(),_d.label=9;case 9:return _i++,[3,2];case 10:errors=[],_b=0,_c=input.claimValidators,_d.label=11;case 11:return _b<_c.length?[4,(validator=_c[_b]).validate(accessTokenPayload,input.userContext)]:[3,14];case 12:(validationRes=_d.sent()).isValid||errors.push({validatorId:validator.id,reason:validationRes.reason}),_d.label=13;case 13:return _b++,[3,11];case 14:return[2,errors]}}))}))},shouldDoInterceptionBasedOnUrl:function(toCheckUrl,apiDomain,sessionTokenBackendDomain){if((0,logger_1.logDebugMessage)("shouldDoInterceptionBasedOnUrl: toCheckUrl: "+toCheckUrl+" apiDomain: "+apiDomain+" sessionTokenBackendDomain: "+sessionTokenBackendDomain),toCheckUrl.includes("superTokensDoNotDoInterception"))return!1;toCheckUrl=(0,utils_1.normaliseURLDomainOrThrowError)(toCheckUrl);var urlObj=new URL(toCheckUrl),domain=urlObj.hostname;if(void 0===sessionTokenBackendDomain){domain=""===urlObj.port?domain:domain+":"+urlObj.port,apiDomain=(0,utils_1.normaliseURLDomainOrThrowError)(apiDomain);var apiUrlObj=new URL(apiDomain);return domain===(""===apiUrlObj.port?apiUrlObj.hostname:apiUrlObj.hostname+":"+apiUrlObj.port)}var normalisedsessionDomain=(0,utils_1.normaliseSessionScopeOrThrowError)(sessionTokenBackendDomain);if(sessionTokenBackendDomain.split(":").length>1){var portStr=sessionTokenBackendDomain.split(":")[sessionTokenBackendDomain.split(":").length-1];(function isNumeric(str){return"string"==typeof str&&!isNaN(str)&&!isNaN(parseFloat(str))})(portStr)&&(normalisedsessionDomain+=":"+portStr,domain=""===urlObj.port?domain:domain+":"+urlObj.port)}return sessionTokenBackendDomain.startsWith(".")?("."+domain).endsWith(normalisedsessionDomain):domain===normalisedsessionDomain}}}},"../supertokens-web-js/node_modules/supertokens-website/lib/build/utils/cookieHandler/defaultImplementation.js":function(__unused_webpack_module,exports,__webpack_require__){var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.defaultCookieHandlerImplementation=void 0;var windowHandler_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/utils/windowHandler/index.js");exports.defaultCookieHandlerImplementation={getCookie:function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){return[2,windowHandler_1.default.getReferenceOrThrow().windowHandler.getWindowUnsafe().document.cookie]}))}))},setCookie:function(cookieString){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){return windowHandler_1.default.getReferenceOrThrow().windowHandler.getWindowUnsafe().document.cookie=cookieString,[2]}))}))}}},"../supertokens-web-js/node_modules/supertokens-website/lib/build/utils/cookieHandler/index.js":function(__unused_webpack_module,exports,__webpack_require__){Object.defineProperty(exports,"__esModule",{value:!0}),exports.CookieHandlerReference=void 0;var defaultImplementation_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/utils/cookieHandler/defaultImplementation.js"),CookieHandlerReference=function(){function CookieHandlerReference(cookieHandlerInput){var cookieHandlerFunc=function(original){return original};void 0!==cookieHandlerInput&&(cookieHandlerFunc=cookieHandlerInput),this.cookieHandler=cookieHandlerFunc(defaultImplementation_1.defaultCookieHandlerImplementation)}return CookieHandlerReference.init=function(cookieHandlerInput){void 0===CookieHandlerReference.instance&&(CookieHandlerReference.instance=new CookieHandlerReference(cookieHandlerInput))},CookieHandlerReference.getReferenceOrThrow=function(){if(void 0===CookieHandlerReference.instance)throw new Error("SuperTokensCookieHandler must be initialized before calling this method.");return CookieHandlerReference.instance},CookieHandlerReference}();exports.CookieHandlerReference=CookieHandlerReference,exports.default=CookieHandlerReference},"../supertokens-web-js/node_modules/supertokens-website/lib/build/utils/globalClaimValidators.js":function(__unused_webpack_module,exports,__webpack_require__){Object.defineProperty(exports,"__esModule",{value:!0}),exports.getGlobalClaimValidators=void 0;var _1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/utils/index.js"),fetch_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/fetch.js"),sessionClaimValidatorStore_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/utils/sessionClaimValidatorStore.js");exports.getGlobalClaimValidators=function getGlobalClaimValidators(overrideGlobalClaimValidators,userContext){var normalisedUserContext=(0,_1.getNormalisedUserContext)(userContext),claimValidatorsAddedByOtherRecipes=sessionClaimValidatorStore_1.default.getClaimValidatorsAddedByOtherRecipes(),globalClaimValidators=fetch_1.default.recipeImpl.getGlobalClaimValidators({claimValidatorsAddedByOtherRecipes:claimValidatorsAddedByOtherRecipes,userContext:normalisedUserContext});return void 0!==overrideGlobalClaimValidators?overrideGlobalClaimValidators(globalClaimValidators,normalisedUserContext):globalClaimValidators}},"../supertokens-web-js/node_modules/supertokens-website/lib/build/utils/index.js":function(__unused_webpack_module,exports,__webpack_require__){var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t},__assign.apply(this,arguments)},__awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.getNormalisedUserContext=exports.validateAndNormaliseInputOrThrowError=exports.normaliseSessionScopeOrThrowError=exports.normaliseURLPathOrThrowError=exports.normaliseURLDomainOrThrowError=void 0;var normalisedURLDomain_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/normalisedURLDomain.js"),normalisedURLPath_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/normalisedURLPath.js"),windowHandler_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/utils/windowHandler/index.js"),logger_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/logger.js");function normaliseURLDomainOrThrowError(input){return new normalisedURLDomain_1.default(input).getAsStringDangerous()}function normaliseURLPathOrThrowError(input){return new normalisedURLPath_1.default(input).getAsStringDangerous()}function normaliseSessionScopeOrThrowError(sessionTokenFrontendDomain){var noDotNormalised=function helper(sessionTokenFrontendDomain){(sessionTokenFrontendDomain=sessionTokenFrontendDomain.trim().toLowerCase()).startsWith(".")&&(sessionTokenFrontendDomain=sessionTokenFrontendDomain.substr(1)),sessionTokenFrontendDomain.startsWith("http://")||sessionTokenFrontendDomain.startsWith("https://")||(sessionTokenFrontendDomain="http://"+sessionTokenFrontendDomain);try{return(sessionTokenFrontendDomain=new URL(sessionTokenFrontendDomain).hostname).startsWith(".")&&(sessionTokenFrontendDomain=sessionTokenFrontendDomain.substr(1)),sessionTokenFrontendDomain}catch(err){throw new Error("Please provide a valid sessionTokenFrontendDomain")}}(sessionTokenFrontendDomain);return"localhost"===noDotNormalised||(0,normalisedURLDomain_1.isAnIpAddress)(noDotNormalised)?noDotNormalised:sessionTokenFrontendDomain.startsWith(".")?"."+noDotNormalised:noDotNormalised}exports.normaliseURLDomainOrThrowError=normaliseURLDomainOrThrowError,exports.normaliseURLPathOrThrowError=normaliseURLPathOrThrowError,exports.normaliseSessionScopeOrThrowError=normaliseSessionScopeOrThrowError,exports.validateAndNormaliseInputOrThrowError=function validateAndNormaliseInputOrThrowError(options){var _this=this,apiDomain=normaliseURLDomainOrThrowError(options.apiDomain),apiBasePath=normaliseURLPathOrThrowError("/auth");void 0!==options.apiBasePath&&(apiBasePath=normaliseURLPathOrThrowError(options.apiBasePath));var defaultSessionScope=windowHandler_1.default.getReferenceOrThrow().windowHandler.location.getHostName(),sessionTokenFrontendDomain=normaliseSessionScopeOrThrowError(void 0!==options&&void 0!==options.sessionTokenFrontendDomain?options.sessionTokenFrontendDomain:defaultSessionScope),sessionExpiredStatusCode=401;void 0!==options.sessionExpiredStatusCode&&(sessionExpiredStatusCode=options.sessionExpiredStatusCode);var invalidClaimStatusCode=403;if(void 0!==options.invalidClaimStatusCode&&(invalidClaimStatusCode=options.invalidClaimStatusCode),sessionExpiredStatusCode===invalidClaimStatusCode)throw new Error("sessionExpiredStatusCode and invalidClaimStatusCode cannot be the same.");var autoAddCredentials=!0;void 0!==options.autoAddCredentials&&(autoAddCredentials=options.autoAddCredentials);var isInIframe=!1;void 0!==options.isInIframe&&(isInIframe=options.isInIframe);var sessionTokenBackendDomain=void 0;void 0!==options.sessionTokenBackendDomain&&(sessionTokenBackendDomain=normaliseSessionScopeOrThrowError(options.sessionTokenBackendDomain));var preAPIHook=function(context){return __awaiter(_this,void 0,void 0,(function(){return __generator(this,(function(_a){return[2,{url:context.url,requestInit:context.requestInit}]}))}))};void 0!==options.preAPIHook&&(preAPIHook=options.preAPIHook);var postAPIHook=function(){return __awaiter(_this,void 0,void 0,(function(){return __generator(this,(function(_a){return[2]}))}))};void 0!==options.postAPIHook&&(postAPIHook=options.postAPIHook);var onHandleEvent=function(){};void 0!==options.onHandleEvent&&(onHandleEvent=options.onHandleEvent);var override=__assign({functions:function(oI){return oI}},options.override);return void 0!==options.enableDebugLogs&&options.enableDebugLogs&&(0,logger_1.enableLogging)(),{apiDomain:apiDomain,apiBasePath:apiBasePath,sessionTokenFrontendDomain:sessionTokenFrontendDomain,sessionExpiredStatusCode:sessionExpiredStatusCode,invalidClaimStatusCode:invalidClaimStatusCode,autoAddCredentials:autoAddCredentials,isInIframe:isInIframe,tokenTransferMethod:void 0!==options.tokenTransferMethod?options.tokenTransferMethod:"cookie",sessionTokenBackendDomain:sessionTokenBackendDomain,preAPIHook:preAPIHook,postAPIHook:postAPIHook,onHandleEvent:onHandleEvent,override:override}},exports.getNormalisedUserContext=function getNormalisedUserContext(userContext){return void 0===userContext?{}:userContext}},"../supertokens-web-js/node_modules/supertokens-website/lib/build/utils/lockFactory/index.js":function(__unused_webpack_module,exports,__webpack_require__){Object.defineProperty(exports,"__esModule",{value:!0}),exports.LockFactoryReference=void 0;var browser_tabs_lock_1=__webpack_require__("../supertokens-web-js/node_modules/browser-tabs-lock/index.js"),LockFactoryReference=function(){function LockFactoryReference(lockFactory){this.lockFactory=lockFactory}return LockFactoryReference.init=function(lockFactory,storageHandler){void 0===this.instance&&(this.instance=new LockFactoryReference(null!=lockFactory?lockFactory:function(storageHandler){return function(){return Promise.resolve(new browser_tabs_lock_1.default(storageHandler))}}(storageHandler)))},LockFactoryReference.getReferenceOrThrow=function(){if(void 0===LockFactoryReference.instance)throw new Error("SuperTokensLockReference must be initialized before calling this method.");return LockFactoryReference.instance},LockFactoryReference}();exports.LockFactoryReference=LockFactoryReference,exports.default=LockFactoryReference},"../supertokens-web-js/node_modules/supertokens-website/lib/build/utils/sessionClaimValidatorStore.js":function(__unused_webpack_module,exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.SessionClaimValidatorStore=void 0;var SessionClaimValidatorStore=function(){function SessionClaimValidatorStore(){}return SessionClaimValidatorStore.claimValidatorsAddedByOtherRecipes=[],SessionClaimValidatorStore.addClaimValidatorFromOtherRecipe=function(builder){SessionClaimValidatorStore.claimValidatorsAddedByOtherRecipes.push(builder)},SessionClaimValidatorStore.getClaimValidatorsAddedByOtherRecipes=function(){return SessionClaimValidatorStore.claimValidatorsAddedByOtherRecipes},SessionClaimValidatorStore}();exports.SessionClaimValidatorStore=SessionClaimValidatorStore,exports.default=SessionClaimValidatorStore},"../supertokens-web-js/node_modules/supertokens-website/lib/build/utils/windowHandler/defaultImplementation.js":function(__unused_webpack_module,exports){var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}};function getWindowOrThrow(){if("undefined"==typeof window)throw Error("If you are using this package with server-side rendering, please make sure that you are checking if the window object is defined.");return window}Object.defineProperty(exports,"__esModule",{value:!0}),exports.defaultWindowHandlerImplementation=void 0;var defaultLocalStorageHandler={key:function(index){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){return[2,getWindowOrThrow().localStorage.key(index)]}))}))},clear:function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){return[2,getWindowOrThrow().localStorage.clear()]}))}))},getItem:function(key){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){return[2,getWindowOrThrow().localStorage.getItem(key)]}))}))},removeItem:function(key){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){return[2,getWindowOrThrow().localStorage.removeItem(key)]}))}))},setItem:function(key,value){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){return[2,getWindowOrThrow().localStorage.setItem(key,value)]}))}))},keySync:function(index){return getWindowOrThrow().localStorage.key(index)},clearSync:function(){return getWindowOrThrow().localStorage.clear()},getItemSync:function(key){return getWindowOrThrow().localStorage.getItem(key)},removeItemSync:function(key){return getWindowOrThrow().localStorage.removeItem(key)},setItemSync:function(key,value){return getWindowOrThrow().localStorage.setItem(key,value)}},defaultSessionStorageHandler={key:function(index){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){return[2,getWindowOrThrow().sessionStorage.key(index)]}))}))},clear:function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){return[2,getWindowOrThrow().sessionStorage.clear()]}))}))},getItem:function(key){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){return[2,getWindowOrThrow().sessionStorage.getItem(key)]}))}))},removeItem:function(key){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){return[2,getWindowOrThrow().sessionStorage.removeItem(key)]}))}))},setItem:function(key,value){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){return[2,getWindowOrThrow().sessionStorage.setItem(key,value)]}))}))},keySync:function(index){return getWindowOrThrow().sessionStorage.key(index)},clearSync:function(){return getWindowOrThrow().sessionStorage.clear()},getItemSync:function(key){return getWindowOrThrow().sessionStorage.getItem(key)},removeItemSync:function(key){return getWindowOrThrow().sessionStorage.removeItem(key)},setItemSync:function(key,value){return getWindowOrThrow().sessionStorage.setItem(key,value)}};exports.defaultWindowHandlerImplementation={history:{replaceState:function(data,unused,url){return getWindowOrThrow().history.replaceState(data,unused,url)},getState:function(){return getWindowOrThrow().history.state}},location:{getHref:function(){return getWindowOrThrow().location.href},setHref:function(href){getWindowOrThrow().location.href=href},getSearch:function(){return getWindowOrThrow().location.search},getHash:function(){return getWindowOrThrow().location.hash},getPathName:function(){return getWindowOrThrow().location.pathname},assign:function(url){getWindowOrThrow().location.assign(url)},getHostName:function(){return getWindowOrThrow().location.hostname},getHost:function(){return getWindowOrThrow().location.host},getOrigin:function(){return getWindowOrThrow().location.origin}},getDocument:function(){return getWindowOrThrow().document},getWindowUnsafe:function(){return getWindowOrThrow().window},localStorage:defaultLocalStorageHandler,sessionStorage:defaultSessionStorageHandler}},"../supertokens-web-js/node_modules/supertokens-website/lib/build/utils/windowHandler/index.js":function(__unused_webpack_module,exports,__webpack_require__){Object.defineProperty(exports,"__esModule",{value:!0}),exports.WindowHandlerReference=void 0;var defaultImplementation_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/utils/windowHandler/defaultImplementation.js"),WindowHandlerReference=function(){function WindowHandlerReference(windowHandlerInput){var windowHandlerFunc=function(original){return original};void 0!==windowHandlerInput&&(windowHandlerFunc=windowHandlerInput),this.windowHandler=windowHandlerFunc(defaultImplementation_1.defaultWindowHandlerImplementation)}return WindowHandlerReference.init=function(windowHandlerInput){void 0===WindowHandlerReference.instance&&(WindowHandlerReference.instance=new WindowHandlerReference(windowHandlerInput))},WindowHandlerReference.getReferenceOrThrow=function(){if(void 0===WindowHandlerReference.instance)throw new Error("SuperTokensWindowHandler must be initialized before calling this method.");return WindowHandlerReference.instance},WindowHandlerReference}();exports.WindowHandlerReference=WindowHandlerReference,exports.default=WindowHandlerReference},"../supertokens-web-js/node_modules/supertokens-website/lib/build/version.js":function(__unused_webpack_module,exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.supported_fdi=exports.package_version=void 0,exports.package_version="17.0.3",exports.supported_fdi=["1.16","1.17","1.18"]},"../supertokens-web-js/node_modules/supertokens-website/lib/build/xmlhttprequest.js":function(__unused_webpack_module,exports,__webpack_require__){var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.addInterceptorsToXMLHttpRequest=void 0;var fetch_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/fetch.js"),logger_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/logger.js"),windowHandler_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/utils/windowHandler/index.js"),processState_1=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/processState.js"),XHR_EVENTS=["readystatechange","abort","error","load","loadend","loadstart","progress","timeout"];function getXMLHttpStatusAndResponseTextFromFetchResponse(response){return __awaiter(this,void 0,void 0,(function(){var contentType,data,responseType,_b,_c;return __generator(this,(function(_d){switch(_d.label){case 0:if(contentType=response.headers.get("content-type"),data="",responseType="text",null!==contentType)return[3,5];_d.label=1;case 1:return _d.trys.push([1,3,,4]),[4,response.text()];case 2:return data=_d.sent(),[3,4];case 3:return _d.sent(),data="",[3,4];case 4:return[3,9];case 5:return contentType.includes("application/json")?(responseType="json",_c=(_b=JSON).stringify,[4,response.json()]):[3,7];case 6:return data=_c.apply(_b,[_d.sent()]),[3,9];case 7:return contentType.includes("text/")?[4,response.text()]:[3,9];case 8:data=_d.sent(),_d.label=9;case 9:return[2,{status:response.status,responseText:data,statusText:response.statusText,responseType:responseType,headers:response.headers}]}}))}))}function setAuthorizationHeaderIfRequired(xhr,requestHeaders){return __awaiter(this,void 0,void 0,(function(){var accessToken,refreshToken;return __generator(this,(function(_a){switch(_a.label){case 0:return(0,logger_1.logDebugMessage)("setAuthorizationHeaderIfRequired: adding existing tokens as header"),[4,(0,fetch_1.getTokenForHeaderAuth)("access")];case 1:return accessToken=_a.sent(),[4,(0,fetch_1.getTokenForHeaderAuth)("refresh")];case 2:return refreshToken=_a.sent(),void 0!==accessToken&&void 0!==refreshToken?requestHeaders.some((function(_a){return"authorization"===_a.name.toLowerCase()}))?(0,logger_1.logDebugMessage)("setAuthorizationHeaderIfRequired: Authorization header defined by the user, not adding"):void 0!==accessToken&&((0,logger_1.logDebugMessage)("setAuthorizationHeaderIfRequired: added authorization header"),xhr.setRequestHeader("Authorization","Bearer ".concat(accessToken))):(0,logger_1.logDebugMessage)("setAuthorizationHeaderIfRequired: token for header based auth not found"),[2]}}))}))}function saveTokensFromHeaders(headers){return __awaiter(this,void 0,void 0,(function(){var refreshToken,accessToken,frontToken,antiCsrfToken,tok;return __generator(this,(function(_a){switch(_a.label){case 0:return(0,logger_1.logDebugMessage)("saveTokensFromHeaders: Saving updated tokens from the response"),null===(refreshToken=headers.get("st-refresh-token"))?[3,2]:((0,logger_1.logDebugMessage)("saveTokensFromHeaders: saving new refresh token"),[4,(0,fetch_1.setToken)("refresh",refreshToken)]);case 1:_a.sent(),_a.label=2;case 2:return null===(accessToken=headers.get("st-access-token"))?[3,4]:((0,logger_1.logDebugMessage)("saveTokensFromHeaders: saving new access token"),[4,(0,fetch_1.setToken)("access",accessToken)]);case 3:_a.sent(),_a.label=4;case 4:return null===(frontToken=headers.get("front-token"))?[3,6]:((0,logger_1.logDebugMessage)("saveTokensFromHeaders: Setting sFrontToken: "+frontToken),[4,fetch_1.FrontToken.setItem(frontToken)]);case 5:_a.sent(),_a.label=6;case 6:return null===(antiCsrfToken=headers.get("anti-csrf"))?[3,9]:[4,(0,fetch_1.getLocalSessionState)(!0)];case 7:return"EXISTS"!==(tok=_a.sent()).status?[3,9]:((0,logger_1.logDebugMessage)("saveTokensFromHeaders: Setting anti-csrf token"),[4,fetch_1.AntiCsrfToken.setItem(tok.lastAccessTokenUpdate,antiCsrfToken)]);case 8:_a.sent(),_a.label=9;case 9:return[2]}}))}))}exports.addInterceptorsToXMLHttpRequest=function addInterceptorsToXMLHttpRequest(){var firstEventLoopDone=new Promise((function(res){return setTimeout(res,0)})),oldXMLHttpRequest=XMLHttpRequest;(0,logger_1.logDebugMessage)("addInterceptorsToXMLHttpRequest called"),XMLHttpRequest=function(){var actual=new oldXMLHttpRequest,delayedQueue=firstEventLoopDone;function delayIfNecessary(cb){delayedQueue=delayedQueue.finally((function(){var _a;return null===(_a=cb())||void 0===_a?void 0:_a.catch(console.error)}))}var customResponseHeaders,body,self=this,listOfFunctionCallsInProxy=[],requestHeaders=[],customGetterValues={},eventHandlers=new Map,url="",doNotDoInterception=!1,preRequestLSS=void 0;function redispatchEvent(name,ev){var handlers=eventHandlers.get(name);(0,logger_1.logDebugMessage)("XHRInterceptor dispatching ".concat(ev.type," to ").concat(handlers?handlers.size:0," listeners")),handlers&&Array.from(handlers).forEach((function(handler){return handler.apply(self,[ev])}))}function handleRetryPostRefreshing(){return __awaiter(this,void 0,void 0,(function(){var refreshResult,retryXhr;return __generator(this,(function(_a){switch(_a.label){case 0:if(void 0===preRequestLSS)throw new Error("Should never come here..");return(0,logger_1.logDebugMessage)("XHRInterceptor.handleRetryPostRefreshing: preRequestLSS "+preRequestLSS.status),[4,(0,fetch_1.onUnauthorisedResponse)(preRequestLSS)];case 1:if("RETRY"!==(refreshResult=_a.sent()).result){if((0,logger_1.logDebugMessage)("XHRInterceptor.handleRetryPostRefreshing: Not retrying original request "+!!refreshResult.error),void 0!==refreshResult.error)throw refreshResult.error;return[2,!0]}return(0,logger_1.logDebugMessage)("XHRInterceptor.handleRetryPostRefreshing: Retrying original request"),retryXhr=new oldXMLHttpRequest,setUpXHR(self,retryXhr,!0),listOfFunctionCallsInProxy.forEach((function(i){i(retryXhr)})),sendXHR(retryXhr,body),[2,!1]}}))}))}function handleResponse(xhr){return __awaiter(this,void 0,void 0,(function(){var status_1,headers,err_1,resp;return __generator(this,(function(_a){switch(_a.label){case 0:if(doNotDoInterception)return(0,logger_1.logDebugMessage)("XHRInterceptor.handleResponse: Returning without interception"),[2,!0];_a.label=1;case 1:_a.trys.push([1,14,,18]),_a.label=2;case 2:return _a.trys.push([2,,8,13]),(0,logger_1.logDebugMessage)("XHRInterceptor.handleResponse: Interception started"),processState_1.ProcessState.getInstance().addState(processState_1.PROCESS_STATE.CALLING_INTERCEPTION_RESPONSE),status_1=xhr.status,headers=function getResponseHeadersFromXHR(xhr){return new Headers(xhr.getAllResponseHeaders().split("\r\n").map((function(line){var sep=line.indexOf(": ");return-1===sep?["",""]:[line.slice(0,sep),line.slice(sep+2)]})).filter((function(e){return 0!==e[0].length})))}(xhr),[4,saveTokensFromHeaders(headers)];case 3:return _a.sent(),(0,fetch_1.fireSessionUpdateEventsIfNecessary)("EXISTS"===preRequestLSS.status,status_1,headers.get("front-token")),status_1!==fetch_1.default.config.sessionExpiredStatusCode?[3,5]:((0,logger_1.logDebugMessage)("responseInterceptor: Status code is: "+status_1),[4,handleRetryPostRefreshing()]);case 4:return[2,_a.sent()];case 5:return status_1!==fetch_1.default.config.invalidClaimStatusCode?[3,7]:[4,(0,fetch_1.onInvalidClaimResponse)({data:JSON.parse(xhr.responseText)})];case 6:_a.sent(),_a.label=7;case 7:return[2,!0];case 8:return(0,logger_1.logDebugMessage)("XHRInterceptor.handleResponse: doFinallyCheck running"),[4,(0,fetch_1.getLocalSessionState)(!1)];case 9:return"EXISTS"===_a.sent().status?[3,12]:((0,logger_1.logDebugMessage)("XHRInterceptor.handleResponse: local session doesn't exist, so removing anti-csrf and sFrontToken"),[4,fetch_1.AntiCsrfToken.removeToken()]);case 10:return _a.sent(),[4,fetch_1.FrontToken.removeToken()];case 11:_a.sent(),_a.label=12;case 12:return[7];case 13:return[3,18];case 14:return err_1=_a.sent(),(0,logger_1.logDebugMessage)("XHRInterceptor.handleResponse: caught error"),void 0===err_1.status?[3,16]:[4,getXMLHttpStatusAndResponseTextFromFetchResponse(err_1)];case 15:if(resp=_a.sent(),customGetterValues.status=resp.status,customGetterValues.statusText=resp.statusText,customGetterValues.responseType=resp.responseType,customResponseHeaders=resp.headers,"json"===resp.responseType)try{customGetterValues.response=JSON.parse(resp.responseText)}catch(_b){customGetterValues.response=resp.responseText}else customGetterValues.response=resp.responseText;return customGetterValues.responseText=resp.responseText,[3,17];case 16:redispatchEvent("error",new Event("error")),_a.label=17;case 17:return[2,!0];case 18:return[2]}}))}))}self.onload=null,self.onreadystatechange=null,self.onloadend=null,self.addEventListener=function(type,listener,_options){var handlers=eventHandlers.get(type);void 0===handlers&&(handlers=new Set,eventHandlers.set(type,handlers)),handlers.add(listener)},self.removeEventListener=function(type,listener){var handlers=eventHandlers.get(type);void 0===handlers&&(handlers=new Set,eventHandlers.set(type,handlers)),handlers.delete(listener)},self.open=function(_,u){(0,logger_1.logDebugMessage)("XHRInterceptor.open called");var args=arguments;url=u;try{doNotDoInterception="string"==typeof url&&!fetch_1.default.recipeImpl.shouldDoInterceptionBasedOnUrl(url,fetch_1.default.config.apiDomain,fetch_1.default.config.sessionTokenBackendDomain)||"string"!=typeof url&&!fetch_1.default.recipeImpl.shouldDoInterceptionBasedOnUrl(url.toString(),fetch_1.default.config.apiDomain,fetch_1.default.config.sessionTokenBackendDomain)}catch(err){if("Please provide a valid domain name"!==err.message)throw err;(0,logger_1.logDebugMessage)("XHRInterceptor.open: Trying shouldDoInterceptionBasedOnUrl with location.origin"),doNotDoInterception=!fetch_1.default.recipeImpl.shouldDoInterceptionBasedOnUrl(windowHandler_1.default.getReferenceOrThrow().windowHandler.location.getOrigin(),fetch_1.default.config.apiDomain,fetch_1.default.config.sessionTokenBackendDomain)}delayIfNecessary((function(){listOfFunctionCallsInProxy.push((function(xhr){xhr.open.apply(xhr,args)})),actual.open.apply(actual,args)}))},self.send=function(inputBody){sendXHR(actual,body=inputBody)},self.setRequestHeader=function(name,value){var _this=this;(0,logger_1.logDebugMessage)("XHRInterceptor.setRequestHeader: Called with ".concat(name)),doNotDoInterception?delayIfNecessary((function(){return actual.setRequestHeader(name,value)})):"anti-csrf"!==name&&delayIfNecessary((function(){return __awaiter(_this,void 0,void 0,(function(){var accessToken,refreshToken;return __generator(this,(function(_a){switch(_a.label){case 0:return"authorization"!==name.toLowerCase()?[3,3]:((0,logger_1.logDebugMessage)("XHRInterceptor.setRequestHeader: checking if user provided auth header matches local token"),[4,(0,fetch_1.getTokenForHeaderAuth)("access")]);case 1:return accessToken=_a.sent(),[4,(0,fetch_1.getTokenForHeaderAuth)("refresh")];case 2:if(refreshToken=_a.sent(),void 0!==accessToken&&void 0!==refreshToken&&value==="Bearer ".concat(accessToken))return(0,logger_1.logDebugMessage)("XHRInterceptor.setRequestHeader: skipping Authorization from user provided headers because it contains our access token"),[2];_a.label=3;case 3:return listOfFunctionCallsInProxy.push((function(xhr){xhr.setRequestHeader(name,value)})),requestHeaders.push({name:name,value:value}),actual.setRequestHeader(name,value),[2]}}))}))}))};var copiedProps=void 0;function setUpXHR(self,xhr,isRetry){var responseProcessed,delayedEvents=["load","loadend","readystatechange"];(0,logger_1.logDebugMessage)("XHRInterceptor.setUpXHR called");for(var _loop_1=function(name_1){(0,logger_1.logDebugMessage)("XHRInterceptor added listener for event ".concat(name_1)),xhr.addEventListener(name_1,(function(ev){(0,logger_1.logDebugMessage)("XHRInterceptor got event ".concat(name_1)),delayedEvents.includes(name_1)||redispatchEvent(name_1,ev)}))},_i=0,XHR_EVENTS_1=XHR_EVENTS;_i<XHR_EVENTS_1.length;_i++){_loop_1(XHR_EVENTS_1[_i])}if(xhr.onload=function(ev){void 0===responseProcessed&&(responseProcessed=handleResponse(xhr)),responseProcessed.then((function(callself){callself&&(self.onload&&self.onload(ev),redispatchEvent("load",ev))}))},xhr.onreadystatechange=function(ev){xhr.readyState===oldXMLHttpRequest.DONE?(void 0===responseProcessed&&(responseProcessed=handleResponse(xhr)),responseProcessed.then((function(callself){callself&&(self.onreadystatechange&&self.onreadystatechange(ev),redispatchEvent("readystatechange",ev))}))):(self.onreadystatechange&&self.onreadystatechange(ev),redispatchEvent("readystatechange",ev))},xhr.onloadend=function(ev){void 0===responseProcessed&&(responseProcessed=handleResponse(xhr)),responseProcessed.then((function(callself){callself&&(self.onloadend&&self.onloadend(ev),redispatchEvent("loadend",ev))}))},self.getAllResponseHeaders=function(){var headersString;return customResponseHeaders?(headersString="",customResponseHeaders.forEach((function(v,k){return headersString+="".concat(k,": ").concat(v,"\r\n")}))):headersString=xhr.getAllResponseHeaders(),headersString+"x-supertokens-xhr-intercepted: true\r\n"},self.getResponseHeader=function(name){return"x-supertokens-xhr-intercepted"===name?"true":customResponseHeaders?customResponseHeaders.get(name):xhr.getResponseHeader(name)},void 0===copiedProps)for(var prop in copiedProps=[],xhr)prop in self||copiedProps.push(prop);for(var _loop_2=function(prop){"function"==typeof xhr[prop]?Object.defineProperty(self,prop,{configurable:!0,value:function(){var args=arguments;return isRetry||listOfFunctionCallsInProxy.push((function(xhr){xhr[prop].apply(xhr,args)})),xhr[prop].apply(xhr,args)}}):Object.defineProperty(self,prop,{configurable:!0,get:function(){return void 0!==customGetterValues[prop]?customGetterValues[prop]:xhr[prop]},set:function(val){isRetry||listOfFunctionCallsInProxy.push((function(xhr){xhr[prop]=val})),(0,logger_1.logDebugMessage)("XHRInterceptor.set[".concat(prop,"] = ").concat(val)),xhr[prop]=val}})},_a=0,copiedProps_1=copiedProps;_a<copiedProps_1.length;_a++){_loop_2(prop=copiedProps_1[_a])}}function sendXHR(xhr,body){var _this=this;if((0,logger_1.logDebugMessage)("XHRInterceptor.send: called"),(0,logger_1.logDebugMessage)("XHRInterceptor.send: Value of doNotDoInterception: "+doNotDoInterception),doNotDoInterception)return(0,logger_1.logDebugMessage)("XHRInterceptor.send: Returning without interception"),void delayIfNecessary((function(){return xhr.send(body)}));(0,logger_1.logDebugMessage)("XHRInterceptor.send: Interception started"),processState_1.ProcessState.getInstance().addState(processState_1.PROCESS_STATE.CALLING_INTERCEPTION_REQUEST),delayIfNecessary((function(){return __awaiter(_this,void 0,void 0,(function(){var antiCsrfToken,transferMethod;return __generator(this,(function(_a){switch(_a.label){case 0:return[4,(0,fetch_1.getLocalSessionState)(!0)];case 1:return"EXISTS"!==(preRequestLSS=_a.sent()).status?[3,3]:[4,fetch_1.AntiCsrfToken.getToken(preRequestLSS.lastAccessTokenUpdate)];case 2:void 0!==(antiCsrfToken=_a.sent())&&((0,logger_1.logDebugMessage)("XHRInterceptor.send: Adding anti-csrf token to request"),xhr.setRequestHeader("anti-csrf",antiCsrfToken)),_a.label=3;case 3:return fetch_1.default.config.autoAddCredentials&&((0,logger_1.logDebugMessage)("XHRInterceptor.send: Adding credentials include"),self.withCredentials=!0),requestHeaders.some((function(i){return"rid"===i.name}))?(0,logger_1.logDebugMessage)("XHRInterceptor.send: rid header was already there in request"):((0,logger_1.logDebugMessage)("XHRInterceptor.send: Adding rid header: anti-csrf"),xhr.setRequestHeader("rid","anti-csrf")),transferMethod=fetch_1.default.config.tokenTransferMethod,requestHeaders.some((function(i){return"st-auth-mode"===i.name}))?(0,logger_1.logDebugMessage)("XHRInterceptor.send: st-auth-mode header was already there in request"):((0,logger_1.logDebugMessage)("XHRInterceptor.send: Adding st-auth-mode header: "+transferMethod),xhr.setRequestHeader("st-auth-mode",transferMethod)),[4,setAuthorizationHeaderIfRequired(xhr,requestHeaders)];case 4:return _a.sent(),(0,logger_1.logDebugMessage)("XHRInterceptor.send: Making user's http call"),[2,xhr.send(body)]}}))}))}))}setUpXHR(self,actual,!1)},XMLHttpRequest.__interceptedBySuperTokens=!0,XMLHttpRequest.__original=oldXMLHttpRequest}},"../supertokens-web-js/node_modules/supertokens-website/utils/cookieHandler/index.js":function(__unused_webpack_module,exports,__webpack_require__){exports.__esModule=!0,function __export(m){for(var p in m)exports.hasOwnProperty(p)||(exports[p]=m[p])}(__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/utils/cookieHandler/index.js"))},"../supertokens-web-js/node_modules/supertokens-website/utils/error/index.js":function(__unused_webpack_module,exports,__webpack_require__){function __export(m){for(var p in m)exports.hasOwnProperty(p)||(exports[p]=m[p])}exports.__esModule=!0;let d=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/error.js");void 0!==d.default?__export(d):__export({default:d,...d})},"../supertokens-web-js/node_modules/supertokens-website/utils/globalClaimValidators/index.js":function(__unused_webpack_module,exports,__webpack_require__){exports.__esModule=!0,function __export(m){for(var p in m)exports.hasOwnProperty(p)||(exports[p]=m[p])}(__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/utils/globalClaimValidators.js"))},"../supertokens-web-js/node_modules/supertokens-website/utils/sessionClaimValidatorStore/index.js":function(__unused_webpack_module,exports,__webpack_require__){function __export(m){for(var p in m)exports.hasOwnProperty(p)||(exports[p]=m[p])}exports.__esModule=!0;let d=__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/utils/sessionClaimValidatorStore.js");void 0!==d.default?__export(d):__export({default:d,...d})},"../supertokens-web-js/node_modules/supertokens-website/utils/windowHandler/index.js":function(__unused_webpack_module,exports,__webpack_require__){exports.__esModule=!0,function __export(m){for(var p in m)exports.hasOwnProperty(p)||(exports[p]=m[p])}(__webpack_require__("../supertokens-web-js/node_modules/supertokens-website/lib/build/utils/windowHandler/index.js"))}}]);